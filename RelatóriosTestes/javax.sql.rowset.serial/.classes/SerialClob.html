


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html id="htmlId">
<head>
  <title>Coverage Report :: SerialClob</title>
  <style type="text/css">
    @import "../../.css/coverage.css";
  </style>
</head>

<body>
<div class="header"></div>

<div class="content">
<div class="breadCrumbs">
    [ <a href="../../index.html">all classes</a> ]
    [ <a href="../index.html">javax.sql.rowset.serial</a> ]
</div>

<h1>Coverage Summary for Class: SerialClob (javax.sql.rowset.serial)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">SerialClob</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 21)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 143)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<div class="sourceCode"><i>1</i>&nbsp;/*
<i>2</i>&nbsp; * Copyright (c) 2003, 2014, Oracle and/or its affiliates. All rights reserved.
<i>3</i>&nbsp; * ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.
<i>4</i>&nbsp; *
<i>5</i>&nbsp; *
<i>6</i>&nbsp; *
<i>7</i>&nbsp; *
<i>8</i>&nbsp; *
<i>9</i>&nbsp; *
<i>10</i>&nbsp; *
<i>11</i>&nbsp; *
<i>12</i>&nbsp; *
<i>13</i>&nbsp; *
<i>14</i>&nbsp; *
<i>15</i>&nbsp; *
<i>16</i>&nbsp; *
<i>17</i>&nbsp; *
<i>18</i>&nbsp; *
<i>19</i>&nbsp; *
<i>20</i>&nbsp; *
<i>21</i>&nbsp; *
<i>22</i>&nbsp; *
<i>23</i>&nbsp; *
<i>24</i>&nbsp; */
<i>25</i>&nbsp;
<i>26</i>&nbsp;package javax.sql.rowset.serial;
<i>27</i>&nbsp;
<i>28</i>&nbsp;import java.sql.*;
<i>29</i>&nbsp;import java.io.*;
<i>30</i>&nbsp;import java.util.Arrays;
<i>31</i>&nbsp;
<i>32</i>&nbsp;/**
<i>33</i>&nbsp; * A serialized mapping in the Java programming language of an SQL
<i>34</i>&nbsp; * &lt;code&gt;CLOB&lt;/code&gt; value.
<i>35</i>&nbsp; * &lt;P&gt;
<i>36</i>&nbsp; * The &lt;code&gt;SerialClob&lt;/code&gt; class provides a constructor for creating
<i>37</i>&nbsp; * an instance from a &lt;code&gt;Clob&lt;/code&gt; object.  Note that the &lt;code&gt;Clob&lt;/code&gt;
<i>38</i>&nbsp; * object should have brought the SQL &lt;code&gt;CLOB&lt;/code&gt; value&#39;s data over
<i>39</i>&nbsp; * to the client before a &lt;code&gt;SerialClob&lt;/code&gt; object
<i>40</i>&nbsp; * is constructed from it.  The data of an SQL &lt;code&gt;CLOB&lt;/code&gt; value can
<i>41</i>&nbsp; * be materialized on the client as a stream of Unicode characters.
<i>42</i>&nbsp; * &lt;P&gt;
<i>43</i>&nbsp; * &lt;code&gt;SerialClob&lt;/code&gt; methods make it possible to get a substring
<i>44</i>&nbsp; * from a &lt;code&gt;SerialClob&lt;/code&gt; object or to locate the start of
<i>45</i>&nbsp; * a pattern of characters.
<i>46</i>&nbsp; *
<i>47</i>&nbsp; * &lt;h3&gt; Thread safety &lt;/h3&gt;
<i>48</i>&nbsp; *
<i>49</i>&nbsp; * &lt;p&gt; A SerialClob is not safe for use by multiple concurrent threads.  If a
<i>50</i>&nbsp; * SerialClob is to be used by more than one thread then access to the SerialClob
<i>51</i>&nbsp; * should be controlled by appropriate synchronization.
<i>52</i>&nbsp; *
<i>53</i>&nbsp; * @author Jonathan Bruce
<i>54</i>&nbsp; * @since 1.5
<i>55</i>&nbsp; */
<i>56</i>&nbsp;public class SerialClob implements Clob, Serializable, Cloneable {
<i>57</i>&nbsp;
<i>58</i>&nbsp;    /**
<i>59</i>&nbsp;     * A serialized array of characters containing the data of the SQL
<i>60</i>&nbsp;     * &lt;code&gt;CLOB&lt;/code&gt; value that this &lt;code&gt;SerialClob&lt;/code&gt; object
<i>61</i>&nbsp;     * represents.
<i>62</i>&nbsp;     *
<i>63</i>&nbsp;     * @serial
<i>64</i>&nbsp;     */
<i>65</i>&nbsp;    private char buf[];
<i>66</i>&nbsp;
<i>67</i>&nbsp;    /**
<i>68</i>&nbsp;     * Internal Clob representation if SerialClob is initialized with a
<i>69</i>&nbsp;     * Clob. Null if SerialClob is initialized with a char[].
<i>70</i>&nbsp;     */
<i>71</i>&nbsp;    private Clob clob;
<i>72</i>&nbsp;
<i>73</i>&nbsp;    /**
<i>74</i>&nbsp;     * The length in characters of this &lt;code&gt;SerialClob&lt;/code&gt; object&#39;s
<i>75</i>&nbsp;     * internal array of characters.
<i>76</i>&nbsp;     *
<i>77</i>&nbsp;     * @serial
<i>78</i>&nbsp;     */
<i>79</i>&nbsp;    private long len;
<i>80</i>&nbsp;
<i>81</i>&nbsp;    /**
<i>82</i>&nbsp;     * The original length in characters of this &lt;code&gt;SerialClob&lt;/code&gt;
<i>83</i>&nbsp;     * object&#39;s internal array of characters.
<i>84</i>&nbsp;     *
<i>85</i>&nbsp;     * @serial
<i>86</i>&nbsp;     */
<i>87</i>&nbsp;    private long origLen;
<i>88</i>&nbsp;
<i>89</i>&nbsp;    /**
<i>90</i>&nbsp;     * Constructs a &lt;code&gt;SerialClob&lt;/code&gt; object that is a serialized version of
<i>91</i>&nbsp;     * the given &lt;code&gt;char&lt;/code&gt; array.
<i>92</i>&nbsp;     * &lt;p&gt;
<i>93</i>&nbsp;     * The new &lt;code&gt;SerialClob&lt;/code&gt; object is initialized with the data from the
<i>94</i>&nbsp;     * &lt;code&gt;char&lt;/code&gt; array, thus allowing disconnected &lt;code&gt;RowSet&lt;/code&gt;
<i>95</i>&nbsp;     * objects to establish a serialized &lt;code&gt;Clob&lt;/code&gt; object without touching
<i>96</i>&nbsp;     * the data source.
<i>97</i>&nbsp;     *
<i>98</i>&nbsp;     * @param ch the char array representing the &lt;code&gt;Clob&lt;/code&gt; object to be
<i>99</i>&nbsp;     *         serialized
<i>100</i>&nbsp;     * @throws SerialException if an error occurs during serialization
<b class="nc"><i>101</i>&nbsp;     * @throws SQLException if a SQL error occurs</b>
<i>102</i>&nbsp;     */
<i>103</i>&nbsp;    public SerialClob(char ch[]) throws SerialException, SQLException {
<i>104</i>&nbsp;
<i>105</i>&nbsp;        // %%% JMB. Agreed. Add code here to throw a SQLException if no
<i>106</i>&nbsp;        // support is available for locatorsUpdateCopy=false
<b class="nc"><i>107</i>&nbsp;        // Serializing locators is not supported.</b>
<b class="nc"><i>108</i>&nbsp;</b>
<b class="nc"><i>109</i>&nbsp;        len = ch.length;</b>
<b class="nc"><i>110</i>&nbsp;        buf = new char[(int)len];</b>
<i>111</i>&nbsp;        for (int i = 0; i &lt; len ; i++){
<b class="nc"><i>112</i>&nbsp;           buf[i] = ch[i];</b>
<b class="nc"><i>113</i>&nbsp;        }</b>
<i>114</i>&nbsp;        origLen = len;
<i>115</i>&nbsp;        clob = null;
<i>116</i>&nbsp;    }
<i>117</i>&nbsp;
<i>118</i>&nbsp;    /**
<i>119</i>&nbsp;     * Constructs a &lt;code&gt;SerialClob&lt;/code&gt; object that is a serialized
<i>120</i>&nbsp;     * version of the given &lt;code&gt;Clob&lt;/code&gt; object.
<i>121</i>&nbsp;     * &lt;P&gt;
<i>122</i>&nbsp;     * The new &lt;code&gt;SerialClob&lt;/code&gt; object is initialized with the
<i>123</i>&nbsp;     * data from the &lt;code&gt;Clob&lt;/code&gt; object; therefore, the
<i>124</i>&nbsp;     * &lt;code&gt;Clob&lt;/code&gt; object should have previously brought the
<i>125</i>&nbsp;     * SQL &lt;code&gt;CLOB&lt;/code&gt; value&#39;s data over to the client from
<i>126</i>&nbsp;     * the database. Otherwise, the new &lt;code&gt;SerialClob&lt;/code&gt; object
<i>127</i>&nbsp;     * object will contain no data.
<i>128</i>&nbsp;     * &lt;p&gt;
<i>129</i>&nbsp;     * Note: The &lt;code&gt;Clob&lt;/code&gt; object supplied to this constructor must
<i>130</i>&nbsp;     * return non-null for both the &lt;code&gt;Clob.getCharacterStream()&lt;/code&gt;
<i>131</i>&nbsp;     * and &lt;code&gt;Clob.getAsciiStream&lt;/code&gt; methods. This &lt;code&gt;SerialClob&lt;/code&gt;
<i>132</i>&nbsp;     * constructor cannot serialize a &lt;code&gt;Clob&lt;/code&gt; object in this instance
<i>133</i>&nbsp;     * and will throw an &lt;code&gt;SQLException&lt;/code&gt; object.
<i>134</i>&nbsp;     *
<i>135</i>&nbsp;     * @param  clob the &lt;code&gt;Clob&lt;/code&gt; object from which this
<i>136</i>&nbsp;     *     &lt;code&gt;SerialClob&lt;/code&gt; object is to be constructed; cannot be null
<i>137</i>&nbsp;     * @throws SerialException if an error occurs during serialization
<i>138</i>&nbsp;     * @throws SQLException if a SQL error occurs in capturing the CLOB;
<i>139</i>&nbsp;     *     if the &lt;code&gt;Clob&lt;/code&gt; object is a null; or if either of the
<i>140</i>&nbsp;     *     &lt;code&gt;Clob.getCharacterStream()&lt;/code&gt; and &lt;code&gt;Clob.getAsciiStream()&lt;/code&gt;
<i>141</i>&nbsp;     *     methods on the &lt;code&gt;Clob&lt;/code&gt; returns a null
<b class="nc"><i>142</i>&nbsp;     * @see java.sql.Clob</b>
<i>143</i>&nbsp;     */
<b class="nc"><i>144</i>&nbsp;    public SerialClob(Clob clob) throws SerialException, SQLException {</b>
<b class="nc"><i>145</i>&nbsp;</b>
<i>146</i>&nbsp;        if (clob == null) {
<i>147</i>&nbsp;            throw new SQLException(&quot;Cannot instantiate a SerialClob &quot; +
<b class="nc"><i>148</i>&nbsp;                &quot;object with a null Clob object&quot;);</b>
<b class="nc"><i>149</i>&nbsp;        }</b>
<b class="nc"><i>150</i>&nbsp;        len = clob.length();</b>
<b class="nc"><i>151</i>&nbsp;        this.clob = clob;</b>
<b class="nc"><i>152</i>&nbsp;        buf = new char[(int)len];</b>
<i>153</i>&nbsp;        int read = 0;
<b class="nc"><i>154</i>&nbsp;        int offset = 0;</b>
<b class="nc"><i>155</i>&nbsp;</b>
<b class="nc"><i>156</i>&nbsp;        try (Reader charStream = clob.getCharacterStream()) {</b>
<i>157</i>&nbsp;            if (charStream == null) {
<i>158</i>&nbsp;                throw new SQLException(&quot;Invalid Clob object. The call to getCharacterStream &quot; +
<i>159</i>&nbsp;                    &quot;returned null which cannot be serialized.&quot;);
<i>160</i>&nbsp;            }
<i>161</i>&nbsp;
<b class="nc"><i>162</i>&nbsp;            // Note: get an ASCII stream in order to null-check it,</b>
<b class="nc"><i>163</i>&nbsp;            // even though we don&#39;t do anything with it.</b>
<b class="nc"><i>164</i>&nbsp;            try (InputStream asciiStream = clob.getAsciiStream()) {</b>
<i>165</i>&nbsp;                if (asciiStream == null) {
<i>166</i>&nbsp;                    throw new SQLException(&quot;Invalid Clob object. The call to getAsciiStream &quot; +
<b class="nc"><i>167</i>&nbsp;                        &quot;returned null which cannot be serialized.&quot;);</b>
<i>168</i>&nbsp;                }
<b class="nc"><i>169</i>&nbsp;            }</b>
<i>170</i>&nbsp;
<b class="nc"><i>171</i>&nbsp;            try (Reader reader = new BufferedReader(charStream)) {</b>
<b class="nc"><i>172</i>&nbsp;                do {</b>
<b class="nc"><i>173</i>&nbsp;                    read = reader.read(buf, offset, (int)(len - offset));</b>
<b class="nc"><i>174</i>&nbsp;                    offset += read;</b>
<b class="nc"><i>175</i>&nbsp;                } while (read &gt; 0);</b>
<b class="nc"><i>176</i>&nbsp;            }</b>
<b class="nc"><i>177</i>&nbsp;        } catch (java.io.IOException ex) {</b>
<i>178</i>&nbsp;            throw new SerialException(&quot;SerialClob: &quot; + ex.getMessage());
<b class="nc"><i>179</i>&nbsp;        }</b>
<i>180</i>&nbsp;
<i>181</i>&nbsp;        origLen = len;
<i>182</i>&nbsp;    }
<i>183</i>&nbsp;
<i>184</i>&nbsp;    /**
<i>185</i>&nbsp;     * Retrieves the number of characters in this &lt;code&gt;SerialClob&lt;/code&gt;
<i>186</i>&nbsp;     * object&#39;s array of characters.
<i>187</i>&nbsp;     *
<i>188</i>&nbsp;     * @return a &lt;code&gt;long&lt;/code&gt; indicating the length in characters of this
<i>189</i>&nbsp;     *         &lt;code&gt;SerialClob&lt;/code&gt; object&#39;s array of character
<i>190</i>&nbsp;     * @throws SerialException if an error occurs;
<i>191</i>&nbsp;     * if {@code free} had previously been called on this object
<b class="nc"><i>192</i>&nbsp;     */</b>
<b class="nc"><i>193</i>&nbsp;    public long length() throws SerialException {</b>
<i>194</i>&nbsp;        isValid();
<i>195</i>&nbsp;        return len;
<i>196</i>&nbsp;    }
<i>197</i>&nbsp;
<i>198</i>&nbsp;    /**
<i>199</i>&nbsp;     * Returns this &lt;code&gt;SerialClob&lt;/code&gt; object&#39;s data as a stream
<i>200</i>&nbsp;     * of Unicode characters. Unlike the related method, &lt;code&gt;getAsciiStream&lt;/code&gt;,
<i>201</i>&nbsp;     * a stream is produced regardless of whether the &lt;code&gt;SerialClob&lt;/code&gt; object
<i>202</i>&nbsp;     * was created with a &lt;code&gt;Clob&lt;/code&gt; object or a &lt;code&gt;char&lt;/code&gt; array.
<i>203</i>&nbsp;     *
<i>204</i>&nbsp;     * @return a &lt;code&gt;java.io.Reader&lt;/code&gt; object containing this
<i>205</i>&nbsp;     *         &lt;code&gt;SerialClob&lt;/code&gt; object&#39;s data
<i>206</i>&nbsp;     * @throws SerialException if an error occurs;
<i>207</i>&nbsp;     * if {@code free} had previously been called on this object
<b class="nc"><i>208</i>&nbsp;     */</b>
<b class="nc"><i>209</i>&nbsp;    public java.io.Reader getCharacterStream() throws SerialException {</b>
<i>210</i>&nbsp;        isValid();
<i>211</i>&nbsp;        return (java.io.Reader) new CharArrayReader(buf);
<i>212</i>&nbsp;    }
<i>213</i>&nbsp;
<i>214</i>&nbsp;    /**
<i>215</i>&nbsp;     * Retrieves the &lt;code&gt;CLOB&lt;/code&gt; value designated by this &lt;code&gt;SerialClob&lt;/code&gt;
<i>216</i>&nbsp;     * object as an ascii stream. This method forwards the &lt;code&gt;getAsciiStream&lt;/code&gt;
<i>217</i>&nbsp;     * call to the underlying &lt;code&gt;Clob&lt;/code&gt; object in the event that this
<i>218</i>&nbsp;     * &lt;code&gt;SerialClob&lt;/code&gt; object is instantiated with a &lt;code&gt;Clob&lt;/code&gt;
<i>219</i>&nbsp;     * object. If this &lt;code&gt;SerialClob&lt;/code&gt; object is instantiated with
<i>220</i>&nbsp;     * a &lt;code&gt;char&lt;/code&gt; array, a &lt;code&gt;SerialException&lt;/code&gt; object is thrown.
<i>221</i>&nbsp;     *
<i>222</i>&nbsp;     * @return a &lt;code&gt;java.io.InputStream&lt;/code&gt; object containing
<i>223</i>&nbsp;     *     this &lt;code&gt;SerialClob&lt;/code&gt; object&#39;s data
<i>224</i>&nbsp;     * @throws SerialException if this {@code SerialClob} object was not
<i>225</i>&nbsp;     * instantiated with a &lt;code&gt;Clob&lt;/code&gt; object;
<i>226</i>&nbsp;     * if {@code free} had previously been called on this object
<i>227</i>&nbsp;     * @throws SQLException if there is an error accessing the
<i>228</i>&nbsp;     *     &lt;code&gt;CLOB&lt;/code&gt; value represented by the &lt;code&gt;Clob&lt;/code&gt; object
<i>229</i>&nbsp;     * that was used to create this &lt;code&gt;SerialClob&lt;/code&gt; object
<b class="nc"><i>230</i>&nbsp;     */</b>
<b class="nc"><i>231</i>&nbsp;    public java.io.InputStream getAsciiStream() throws SerialException, SQLException {</b>
<b class="nc"><i>232</i>&nbsp;        isValid();</b>
<i>233</i>&nbsp;        if (this.clob != null) {
<b class="nc"><i>234</i>&nbsp;            return this.clob.getAsciiStream();</b>
<i>235</i>&nbsp;        } else {
<i>236</i>&nbsp;            throw new SerialException(&quot;Unsupported operation. SerialClob cannot &quot; +
<i>237</i>&nbsp;                &quot;return a the CLOB value as an ascii stream, unless instantiated &quot; +
<i>238</i>&nbsp;                &quot;with a fully implemented Clob object.&quot;);
<i>239</i>&nbsp;        }
<i>240</i>&nbsp;    }
<i>241</i>&nbsp;
<i>242</i>&nbsp;    /**
<i>243</i>&nbsp;     * Returns a copy of the substring contained in this
<i>244</i>&nbsp;     * &lt;code&gt;SerialClob&lt;/code&gt; object, starting at the given position
<i>245</i>&nbsp;     * and continuing for the specified number or characters.
<i>246</i>&nbsp;     *
<i>247</i>&nbsp;     * @param pos the position of the first character in the substring
<i>248</i>&nbsp;     *            to be copied; the first character of the
<i>249</i>&nbsp;     *            &lt;code&gt;SerialClob&lt;/code&gt; object is at position
<i>250</i>&nbsp;     *            &lt;code&gt;1&lt;/code&gt;; must not be less than &lt;code&gt;1&lt;/code&gt;,
<i>251</i>&nbsp;     *            and the sum of the starting position and the length
<i>252</i>&nbsp;     *            of the substring must be less than the length of this
<i>253</i>&nbsp;     *            &lt;code&gt;SerialClob&lt;/code&gt; object
<i>254</i>&nbsp;     * @param length the number of characters in the substring to be
<i>255</i>&nbsp;     *               returned; must not be greater than the length of
<i>256</i>&nbsp;     *               this &lt;code&gt;SerialClob&lt;/code&gt; object, and the
<i>257</i>&nbsp;     *               sum of the starting position and the length
<i>258</i>&nbsp;     *               of the substring must be less than the length of this
<i>259</i>&nbsp;     *               &lt;code&gt;SerialClob&lt;/code&gt; object
<i>260</i>&nbsp;     * @return a &lt;code&gt;String&lt;/code&gt; object containing a substring of
<i>261</i>&nbsp;     *         this &lt;code&gt;SerialClob&lt;/code&gt; object beginning at the
<i>262</i>&nbsp;     *         given position and containing the specified number of
<i>263</i>&nbsp;     *         consecutive characters
<i>264</i>&nbsp;     * @throws SerialException if either of the arguments is out of bounds;
<i>265</i>&nbsp;     * if {@code free} had previously been called on this object
<i>266</i>&nbsp;     */
<b class="nc"><i>267</i>&nbsp;    public String getSubString(long pos, int length) throws SerialException {</b>
<b class="nc"><i>268</i>&nbsp;</b>
<b class="nc"><i>269</i>&nbsp;        isValid();</b>
<i>270</i>&nbsp;        if (pos &lt; 1 || pos &gt; this.length()) {
<i>271</i>&nbsp;            throw new SerialException(&quot;Invalid position in SerialClob object set&quot;);
<b class="nc"><i>272</i>&nbsp;        }</b>
<b class="nc"><i>273</i>&nbsp;</b>
<i>274</i>&nbsp;        if ((pos-1) + length &gt; this.length()) {
<i>275</i>&nbsp;            throw new SerialException(&quot;Invalid position and substring length&quot;);
<i>276</i>&nbsp;        }
<b class="nc"><i>277</i>&nbsp;</b>
<i>278</i>&nbsp;        try {
<b class="nc"><i>279</i>&nbsp;            return new String(buf, (int)pos - 1, length);</b>
<b class="nc"><i>280</i>&nbsp;</b>
<b class="nc"><i>281</i>&nbsp;        } catch (StringIndexOutOfBoundsException e) {</b>
<i>282</i>&nbsp;            throw new SerialException(&quot;StringIndexOutOfBoundsException: &quot; +
<i>283</i>&nbsp;                e.getMessage());
<i>284</i>&nbsp;        }
<i>285</i>&nbsp;
<i>286</i>&nbsp;    }
<i>287</i>&nbsp;
<i>288</i>&nbsp;    /**
<i>289</i>&nbsp;     * Returns the position in this &lt;code&gt;SerialClob&lt;/code&gt; object
<i>290</i>&nbsp;     * where the given &lt;code&gt;String&lt;/code&gt; object begins, starting
<i>291</i>&nbsp;     * the search at the specified position. This method returns
<i>292</i>&nbsp;     * &lt;code&gt;-1&lt;/code&gt; if the pattern is not found.
<i>293</i>&nbsp;     *
<i>294</i>&nbsp;     * @param searchStr the &lt;code&gt;String&lt;/code&gt; object for which to
<i>295</i>&nbsp;     *                  search
<i>296</i>&nbsp;     * @param start the position in this &lt;code&gt;SerialClob&lt;/code&gt; object
<i>297</i>&nbsp;     *         at which to start the search; the first position is
<i>298</i>&nbsp;     *         &lt;code&gt;1&lt;/code&gt;; must not be less than &lt;code&gt;1&lt;/code&gt; nor
<i>299</i>&nbsp;     *         greater than the length of this &lt;code&gt;SerialClob&lt;/code&gt; object
<i>300</i>&nbsp;     * @return the position at which the given &lt;code&gt;String&lt;/code&gt; object
<i>301</i>&nbsp;     *         begins, starting the search at the specified position;
<i>302</i>&nbsp;     *         &lt;code&gt;-1&lt;/code&gt; if the given &lt;code&gt;String&lt;/code&gt; object is
<i>303</i>&nbsp;     *         not found or the starting position is out of bounds; position
<i>304</i>&nbsp;     *         numbering for the return value starts at &lt;code&gt;1&lt;/code&gt;
<i>305</i>&nbsp;     * @throws SerialException  if the {@code free} method had been
<i>306</i>&nbsp;     * previously called on this object
<i>307</i>&nbsp;     * @throws SQLException if there is an error accessing the Clob value
<i>308</i>&nbsp;     *         from the database.
<i>309</i>&nbsp;     */
<b class="nc"><i>310</i>&nbsp;    public long position(String searchStr, long start)</b>
<b class="nc"><i>311</i>&nbsp;        throws SerialException, SQLException {</b>
<b class="nc"><i>312</i>&nbsp;        isValid();</b>
<i>313</i>&nbsp;        if (start &lt; 1 || start &gt; len) {
<i>314</i>&nbsp;            return -1;
<b class="nc"><i>315</i>&nbsp;        }</b>
<i>316</i>&nbsp;
<b class="nc"><i>317</i>&nbsp;        char pattern[] = searchStr.toCharArray();</b>
<b class="nc"><i>318</i>&nbsp;</b>
<b class="nc"><i>319</i>&nbsp;        int pos = (int)start-1;</b>
<i>320</i>&nbsp;        int i = 0;
<b class="nc"><i>321</i>&nbsp;        long patlen = pattern.length;</b>
<b class="nc"><i>322</i>&nbsp;</b>
<b class="nc"><i>323</i>&nbsp;        while (pos &lt; len) {</b>
<b class="nc"><i>324</i>&nbsp;            if (pattern[i] == buf[pos]) {</b>
<i>325</i>&nbsp;                if (i + 1 == patlen) {
<b class="nc"><i>326</i>&nbsp;                    return (pos + 1) - (patlen - 1);</b>
<i>327</i>&nbsp;                }
<b class="nc"><i>328</i>&nbsp;                i++; pos++; // increment pos, and i</b>
<b class="nc"><i>329</i>&nbsp;</b>
<i>330</i>&nbsp;            } else if (pattern[i] != buf[pos]) {
<i>331</i>&nbsp;                pos++; // increment pos only
<b class="nc"><i>332</i>&nbsp;            }</b>
<i>333</i>&nbsp;        }
<i>334</i>&nbsp;        return -1; // not found
<i>335</i>&nbsp;    }
<i>336</i>&nbsp;
<i>337</i>&nbsp;    /**
<i>338</i>&nbsp;     * Returns the position in this &lt;code&gt;SerialClob&lt;/code&gt; object
<i>339</i>&nbsp;     * where the given &lt;code&gt;Clob&lt;/code&gt; signature begins, starting
<i>340</i>&nbsp;     * the search at the specified position. This method returns
<i>341</i>&nbsp;     * &lt;code&gt;-1&lt;/code&gt; if the pattern is not found.
<i>342</i>&nbsp;     *
<i>343</i>&nbsp;     * @param searchStr the &lt;code&gt;Clob&lt;/code&gt; object for which to search
<i>344</i>&nbsp;     * @param start the position in this &lt;code&gt;SerialClob&lt;/code&gt; object
<i>345</i>&nbsp;     *        at which to begin the search; the first position is
<i>346</i>&nbsp;     *         &lt;code&gt;1&lt;/code&gt;; must not be less than &lt;code&gt;1&lt;/code&gt; nor
<i>347</i>&nbsp;     *         greater than the length of this &lt;code&gt;SerialClob&lt;/code&gt; object
<i>348</i>&nbsp;     * @return the position at which the given &lt;code&gt;Clob&lt;/code&gt;
<i>349</i>&nbsp;     *         object begins in this &lt;code&gt;SerialClob&lt;/code&gt; object,
<i>350</i>&nbsp;     *         at or after the specified starting position
<i>351</i>&nbsp;     * @throws SerialException if an error occurs locating the Clob signature;
<i>352</i>&nbsp;     * if the {@code free} method had been previously called on this object
<i>353</i>&nbsp;     * @throws SQLException if there is an error accessing the Clob value
<i>354</i>&nbsp;     *         from the database
<i>355</i>&nbsp;     */
<b class="nc"><i>356</i>&nbsp;    public long position(Clob searchStr, long start)</b>
<b class="nc"><i>357</i>&nbsp;        throws SerialException, SQLException {</b>
<i>358</i>&nbsp;        isValid();
<i>359</i>&nbsp;        return position(searchStr.getSubString(1,(int)searchStr.length()), start);
<i>360</i>&nbsp;    }
<i>361</i>&nbsp;
<i>362</i>&nbsp;    /**
<i>363</i>&nbsp;     * Writes the given Java &lt;code&gt;String&lt;/code&gt; to the &lt;code&gt;CLOB&lt;/code&gt;
<i>364</i>&nbsp;     * value that this &lt;code&gt;SerialClob&lt;/code&gt; object represents, at the position
<i>365</i>&nbsp;     * &lt;code&gt;pos&lt;/code&gt;.
<i>366</i>&nbsp;     *
<i>367</i>&nbsp;     * @param pos the position at which to start writing to the &lt;code&gt;CLOB&lt;/code&gt;
<i>368</i>&nbsp;     *         value that this &lt;code&gt;SerialClob&lt;/code&gt; object represents; the first
<i>369</i>&nbsp;     *         position is &lt;code&gt;1&lt;/code&gt;; must not be less than &lt;code&gt;1&lt;/code&gt; nor
<i>370</i>&nbsp;     *         greater than the length of this &lt;code&gt;SerialClob&lt;/code&gt; object
<i>371</i>&nbsp;     * @param str the string to be written to the &lt;code&gt;CLOB&lt;/code&gt;
<i>372</i>&nbsp;     *        value that this &lt;code&gt;SerialClob&lt;/code&gt; object represents
<i>373</i>&nbsp;     * @return the number of characters written
<i>374</i>&nbsp;     * @throws SerialException if there is an error accessing the
<i>375</i>&nbsp;     *     &lt;code&gt;CLOB&lt;/code&gt; value; if an invalid position is set; if an
<i>376</i>&nbsp;     *     invalid offset value is set; if number of bytes to be written
<i>377</i>&nbsp;     *     is greater than the &lt;code&gt;SerialClob&lt;/code&gt; length; or the combined
<i>378</i>&nbsp;     *     values of the length and offset is greater than the Clob buffer;
<i>379</i>&nbsp;     * if the {@code free} method had been previously called on this object
<b class="nc"><i>380</i>&nbsp;     */</b>
<i>381</i>&nbsp;    public int setString(long pos, String str) throws SerialException {
<i>382</i>&nbsp;        return (setString(pos, str, 0, str.length()));
<i>383</i>&nbsp;    }
<i>384</i>&nbsp;
<i>385</i>&nbsp;    /**
<i>386</i>&nbsp;     * Writes &lt;code&gt;len&lt;/code&gt; characters of &lt;code&gt;str&lt;/code&gt;, starting
<i>387</i>&nbsp;     * at character &lt;code&gt;offset&lt;/code&gt;, to the &lt;code&gt;CLOB&lt;/code&gt; value
<i>388</i>&nbsp;     * that this &lt;code&gt;Clob&lt;/code&gt; represents.
<i>389</i>&nbsp;     *
<i>390</i>&nbsp;     * @param pos the position at which to start writing to the &lt;code&gt;CLOB&lt;/code&gt;
<i>391</i>&nbsp;     *         value that this &lt;code&gt;SerialClob&lt;/code&gt; object represents; the first
<i>392</i>&nbsp;     *         position is &lt;code&gt;1&lt;/code&gt;; must not be less than &lt;code&gt;1&lt;/code&gt; nor
<i>393</i>&nbsp;     *         greater than the length of this &lt;code&gt;SerialClob&lt;/code&gt; object
<i>394</i>&nbsp;     * @param str the string to be written to the &lt;code&gt;CLOB&lt;/code&gt;
<i>395</i>&nbsp;     *        value that this &lt;code&gt;Clob&lt;/code&gt; object represents
<i>396</i>&nbsp;     * @param offset the offset into &lt;code&gt;str&lt;/code&gt; to start reading
<i>397</i>&nbsp;     *        the characters to be written
<i>398</i>&nbsp;     * @param length the number of characters to be written
<i>399</i>&nbsp;     * @return the number of characters written
<i>400</i>&nbsp;     * @throws SerialException if there is an error accessing the
<i>401</i>&nbsp;     *     &lt;code&gt;CLOB&lt;/code&gt; value; if an invalid position is set; if an
<i>402</i>&nbsp;     *     invalid offset value is set; if number of bytes to be written
<i>403</i>&nbsp;     *     is greater than the &lt;code&gt;SerialClob&lt;/code&gt; length; or the combined
<i>404</i>&nbsp;     *     values of the length and offset is greater than the Clob buffer;
<i>405</i>&nbsp;     * if the {@code free} method had been previously called on this object
<i>406</i>&nbsp;     */
<b class="nc"><i>407</i>&nbsp;    public int setString(long pos, String str, int offset, int length)</b>
<b class="nc"><i>408</i>&nbsp;        throws SerialException {</b>
<b class="nc"><i>409</i>&nbsp;        isValid();</b>
<i>410</i>&nbsp;        String temp = str.substring(offset);
<b class="nc"><i>411</i>&nbsp;        char cPattern[] = temp.toCharArray();</b>
<b class="nc"><i>412</i>&nbsp;</b>
<i>413</i>&nbsp;        if (offset &lt; 0 || offset &gt; str.length()) {
<i>414</i>&nbsp;            throw new SerialException(&quot;Invalid offset in byte array set&quot;);
<b class="nc"><i>415</i>&nbsp;        }</b>
<b class="nc"><i>416</i>&nbsp;</b>
<i>417</i>&nbsp;        if (pos &lt; 1 || pos &gt; this.length()) {
<i>418</i>&nbsp;            throw new SerialException(&quot;Invalid position in Clob object set&quot;);
<b class="nc"><i>419</i>&nbsp;        }</b>
<b class="nc"><i>420</i>&nbsp;</b>
<i>421</i>&nbsp;        if ((long)(length) &gt; origLen) {
<i>422</i>&nbsp;            throw new SerialException(&quot;Buffer is not sufficient to hold the value&quot;);
<b class="nc"><i>423</i>&nbsp;        }</b>
<i>424</i>&nbsp;
<b class="nc"><i>425</i>&nbsp;        if ((length + offset) &gt; str.length()) {</b>
<i>426</i>&nbsp;            // need check to ensure length + offset !&gt; bytes.length
<i>427</i>&nbsp;            throw new SerialException(&quot;Invalid OffSet. Cannot have combined offset &quot; +
<i>428</i>&nbsp;                &quot; and length that is greater that the Blob buffer&quot;);
<b class="nc"><i>429</i>&nbsp;        }</b>
<b class="nc"><i>430</i>&nbsp;</b>
<b class="nc"><i>431</i>&nbsp;        int i = 0;</b>
<b class="nc"><i>432</i>&nbsp;        pos--;  //values in the array are at position one less</b>
<b class="nc"><i>433</i>&nbsp;        while ( i &lt; length || (offset + i +1) &lt; (str.length() - offset ) ) {</b>
<i>434</i>&nbsp;            this.buf[(int)pos + i ] = cPattern[offset + i ];
<b class="nc"><i>435</i>&nbsp;            i++;</b>
<i>436</i>&nbsp;        }
<i>437</i>&nbsp;        return i;
<i>438</i>&nbsp;    }
<i>439</i>&nbsp;
<i>440</i>&nbsp;    /**
<i>441</i>&nbsp;     * Retrieves a stream to be used to write Ascii characters to the
<i>442</i>&nbsp;     * &lt;code&gt;CLOB&lt;/code&gt; value that this &lt;code&gt;SerialClob&lt;/code&gt; object represents,
<i>443</i>&nbsp;     * starting at position &lt;code&gt;pos&lt;/code&gt;. This method forwards the
<i>444</i>&nbsp;     * &lt;code&gt;setAsciiStream()&lt;/code&gt; call to the underlying &lt;code&gt;Clob&lt;/code&gt; object in
<i>445</i>&nbsp;     * the event that this &lt;code&gt;SerialClob&lt;/code&gt; object is instantiated with a
<i>446</i>&nbsp;     * &lt;code&gt;Clob&lt;/code&gt; object. If this &lt;code&gt;SerialClob&lt;/code&gt; object is instantiated
<i>447</i>&nbsp;     *  with a &lt;code&gt;char&lt;/code&gt; array, a &lt;code&gt;SerialException&lt;/code&gt; object is thrown.
<i>448</i>&nbsp;     *
<i>449</i>&nbsp;     * @param pos the position at which to start writing to the
<i>450</i>&nbsp;     *        &lt;code&gt;CLOB&lt;/code&gt; object
<i>451</i>&nbsp;     * @return the stream to which ASCII encoded characters can be written
<i>452</i>&nbsp;     * @throws SerialException if SerialClob is not instantiated with a
<i>453</i>&nbsp;     *     Clob object;
<i>454</i>&nbsp;     * if the {@code free} method had been previously called on this object
<i>455</i>&nbsp;     * @throws SQLException if there is an error accessing the
<i>456</i>&nbsp;     *     &lt;code&gt;CLOB&lt;/code&gt; value
<i>457</i>&nbsp;     * @see #getAsciiStream
<i>458</i>&nbsp;     */
<b class="nc"><i>459</i>&nbsp;    public java.io.OutputStream setAsciiStream(long pos)</b>
<b class="nc"><i>460</i>&nbsp;        throws SerialException, SQLException {</b>
<b class="nc"><i>461</i>&nbsp;        isValid();</b>
<i>462</i>&nbsp;         if (this.clob != null) {
<b class="nc"><i>463</i>&nbsp;             return this.clob.setAsciiStream(pos);</b>
<i>464</i>&nbsp;         } else {
<i>465</i>&nbsp;             throw new SerialException(&quot;Unsupported operation. SerialClob cannot &quot; +
<i>466</i>&nbsp;                &quot;return a writable ascii stream\n unless instantiated with a Clob object &quot; +
<i>467</i>&nbsp;                &quot;that has a setAsciiStream() implementation&quot;);
<i>468</i>&nbsp;         }
<i>469</i>&nbsp;    }
<i>470</i>&nbsp;
<i>471</i>&nbsp;    /**
<i>472</i>&nbsp;     * Retrieves a stream to be used to write a stream of Unicode characters
<i>473</i>&nbsp;     * to the &lt;code&gt;CLOB&lt;/code&gt; value that this &lt;code&gt;SerialClob&lt;/code&gt; object
<i>474</i>&nbsp;     * represents, at position &lt;code&gt;pos&lt;/code&gt;. This method forwards the
<i>475</i>&nbsp;     * &lt;code&gt;setCharacterStream()&lt;/code&gt; call to the underlying &lt;code&gt;Clob&lt;/code&gt;
<i>476</i>&nbsp;     * object in the event that this &lt;code&gt;SerialClob&lt;/code&gt; object is instantiated with a
<i>477</i>&nbsp;     * &lt;code&gt;Clob&lt;/code&gt; object. If this &lt;code&gt;SerialClob&lt;/code&gt; object is instantiated with
<i>478</i>&nbsp;     * a &lt;code&gt;char&lt;/code&gt; array, a &lt;code&gt;SerialException&lt;/code&gt; is thrown.
<i>479</i>&nbsp;     *
<i>480</i>&nbsp;     * @param  pos the position at which to start writing to the
<i>481</i>&nbsp;     *        &lt;code&gt;CLOB&lt;/code&gt; value
<i>482</i>&nbsp;     *
<i>483</i>&nbsp;     * @return a stream to which Unicode encoded characters can be written
<i>484</i>&nbsp;     * @throws SerialException if the SerialClob is not instantiated with
<i>485</i>&nbsp;     *     a Clob object;
<i>486</i>&nbsp;     * if the {@code free} method had been previously called on this object
<i>487</i>&nbsp;     * @throws SQLException if there is an error accessing the
<i>488</i>&nbsp;     *            &lt;code&gt;CLOB&lt;/code&gt; value
<i>489</i>&nbsp;     * @see #getCharacterStream
<i>490</i>&nbsp;     */
<b class="nc"><i>491</i>&nbsp;    public java.io.Writer setCharacterStream(long pos)</b>
<b class="nc"><i>492</i>&nbsp;        throws SerialException, SQLException {</b>
<b class="nc"><i>493</i>&nbsp;        isValid();</b>
<i>494</i>&nbsp;        if (this.clob != null) {
<b class="nc"><i>495</i>&nbsp;            return this.clob.setCharacterStream(pos);</b>
<i>496</i>&nbsp;        } else {
<i>497</i>&nbsp;            throw new SerialException(&quot;Unsupported operation. SerialClob cannot &quot; +
<i>498</i>&nbsp;                &quot;return a writable character stream\n unless instantiated with a Clob object &quot; +
<i>499</i>&nbsp;                &quot;that has a setCharacterStream implementation&quot;);
<i>500</i>&nbsp;        }
<i>501</i>&nbsp;    }
<i>502</i>&nbsp;
<i>503</i>&nbsp;    /**
<i>504</i>&nbsp;     * Truncates the &lt;code&gt;CLOB&lt;/code&gt; value that this &lt;code&gt;SerialClob&lt;/code&gt;
<i>505</i>&nbsp;     * object represents so that it has a length of &lt;code&gt;len&lt;/code&gt;
<i>506</i>&nbsp;     * characters.
<i>507</i>&nbsp;     * &lt;p&gt;
<i>508</i>&nbsp;     * Truncating a &lt;code&gt;SerialClob&lt;/code&gt; object to length 0 has the effect of
<i>509</i>&nbsp;     * clearing its contents.
<i>510</i>&nbsp;     *
<i>511</i>&nbsp;     * @param length the length, in bytes, to which the &lt;code&gt;CLOB&lt;/code&gt;
<i>512</i>&nbsp;     *        value should be truncated
<i>513</i>&nbsp;     * @throws SerialException if there is an error accessing the
<i>514</i>&nbsp;     *        &lt;code&gt;CLOB&lt;/code&gt; value;
<i>515</i>&nbsp;     * if the {@code free} method had been previously called on this object
<b class="nc"><i>516</i>&nbsp;     */</b>
<b class="nc"><i>517</i>&nbsp;    public void truncate(long length) throws SerialException {</b>
<b class="nc"><i>518</i>&nbsp;        isValid();</b>
<i>519</i>&nbsp;        if (length &gt; len) {
<i>520</i>&nbsp;           throw new SerialException
<b class="nc"><i>521</i>&nbsp;              (&quot;Length more than what can be truncated&quot;);</b>
<i>522</i>&nbsp;        } else {
<i>523</i>&nbsp;             len = length;
<b class="nc"><i>524</i>&nbsp;             // re-size the buffer</b>
<b class="nc"><i>525</i>&nbsp;</b>
<i>526</i>&nbsp;             if (len == 0) {
<b class="nc"><i>527</i>&nbsp;                buf = new char[] {};</b>
<i>528</i>&nbsp;             } else {
<i>529</i>&nbsp;                buf = (this.getSubString(1, (int)len)).toCharArray();
<i>530</i>&nbsp;             }
<i>531</i>&nbsp;        }
<i>532</i>&nbsp;    }
<i>533</i>&nbsp;
<i>534</i>&nbsp;
<i>535</i>&nbsp;    /**
<i>536</i>&nbsp;     * Returns a {@code Reader} object that contains a partial
<i>537</i>&nbsp;     * {@code SerialClob} value, starting
<i>538</i>&nbsp;     * with the character specified by pos, which is length characters in length.
<i>539</i>&nbsp;     *
<i>540</i>&nbsp;     * @param pos the offset to the first character of the partial value to
<i>541</i>&nbsp;     * be retrieved.  The first character in the {@code SerialClob} is at position 1.
<i>542</i>&nbsp;     * @param length the length in characters of the partial value to be retrieved.
<i>543</i>&nbsp;     * @return {@code Reader} through which the partial {@code SerialClob}
<i>544</i>&nbsp;     * value can be read.
<i>545</i>&nbsp;     * @throws SQLException if pos is less than 1 or if pos is greater than the
<i>546</i>&nbsp;     * number of characters in the {@code SerialClob} or if pos + length
<i>547</i>&nbsp;     * is greater than the number of characters in the {@code SerialClob};
<i>548</i>&nbsp;     * @throws SerialException if the {@code free} method had been previously
<i>549</i>&nbsp;     * called on this object
<i>550</i>&nbsp;     * @since 1.6
<b class="nc"><i>551</i>&nbsp;     */</b>
<b class="nc"><i>552</i>&nbsp;    public Reader getCharacterStream(long pos, long length) throws SQLException {</b>
<b class="nc"><i>553</i>&nbsp;        isValid();</b>
<i>554</i>&nbsp;        if (pos &lt; 1 || pos &gt; len) {
<i>555</i>&nbsp;            throw new SerialException(&quot;Invalid position in Clob object set&quot;);
<b class="nc"><i>556</i>&nbsp;        }</b>
<b class="nc"><i>557</i>&nbsp;</b>
<i>558</i>&nbsp;        if ((pos-1) + length &gt; len) {
<b class="nc"><i>559</i>&nbsp;            throw new SerialException(&quot;Invalid position and substring length&quot;);</b>
<b class="nc"><i>560</i>&nbsp;        }</b>
<i>561</i>&nbsp;        if (length &lt;= 0) {
<b class="nc"><i>562</i>&nbsp;            throw new SerialException(&quot;Invalid length specified&quot;);</b>
<i>563</i>&nbsp;        }
<i>564</i>&nbsp;        return new CharArrayReader(buf, (int)pos, (int)length);
<i>565</i>&nbsp;    }
<i>566</i>&nbsp;
<i>567</i>&nbsp;    /**
<i>568</i>&nbsp;     * This method frees the {@code SerialClob} object and releases the
<i>569</i>&nbsp;     * resources that it holds.
<i>570</i>&nbsp;     * The object is invalid once the {@code free} method is called.
<i>571</i>&nbsp;     * &lt;p&gt;
<i>572</i>&nbsp;     * If {@code free} is called multiple times, the subsequent
<i>573</i>&nbsp;     * calls to {@code free} are treated as a no-op.
<i>574</i>&nbsp;     * &lt;/P&gt;
<i>575</i>&nbsp;     * @throws SQLException if an error occurs releasing
<i>576</i>&nbsp;     * the Clob&#39;s resources
<i>577</i>&nbsp;     * @since 1.6
<b class="nc"><i>578</i>&nbsp;     */</b>
<b class="nc"><i>579</i>&nbsp;    public void free() throws SQLException {</b>
<b class="nc"><i>580</i>&nbsp;        if (buf != null) {</b>
<b class="nc"><i>581</i>&nbsp;            buf = null;</b>
<i>582</i>&nbsp;            if (clob != null) {
<b class="nc"><i>583</i>&nbsp;                clob.free();</b>
<i>584</i>&nbsp;            }
<i>585</i>&nbsp;            clob = null;
<i>586</i>&nbsp;        }
<i>587</i>&nbsp;    }
<i>588</i>&nbsp;
<i>589</i>&nbsp;    /**
<i>590</i>&nbsp;     * Compares this SerialClob to the specified object.  The result is {@code
<i>591</i>&nbsp;     * true} if and only if the argument is not {@code null} and is a {@code
<i>592</i>&nbsp;     * SerialClob} object that represents the same sequence of characters as this
<i>593</i>&nbsp;     * object.
<i>594</i>&nbsp;     *
<i>595</i>&nbsp;     * @param  obj The object to compare this {@code SerialClob} against
<i>596</i>&nbsp;     *
<i>597</i>&nbsp;     * @return  {@code true} if the given object represents a {@code SerialClob}
<i>598</i>&nbsp;     *          equivalent to this SerialClob, {@code false} otherwise
<i>599</i>&nbsp;     *
<b class="nc"><i>600</i>&nbsp;     */</b>
<b class="nc"><i>601</i>&nbsp;    public boolean equals(Object obj) {</b>
<i>602</i>&nbsp;        if (this == obj) {
<b class="nc"><i>603</i>&nbsp;            return true;</b>
<b class="nc"><i>604</i>&nbsp;        }</b>
<b class="nc"><i>605</i>&nbsp;        if (obj instanceof SerialClob) {</b>
<b class="nc"><i>606</i>&nbsp;            SerialClob sc = (SerialClob)obj;</b>
<i>607</i>&nbsp;            if (this.len == sc.len) {
<i>608</i>&nbsp;                return Arrays.equals(buf, sc.buf);
<b class="nc"><i>609</i>&nbsp;            }</b>
<i>610</i>&nbsp;        }
<i>611</i>&nbsp;        return false;
<i>612</i>&nbsp;    }
<i>613</i>&nbsp;
<i>614</i>&nbsp;    /**
<i>615</i>&nbsp;     * Returns a hash code for this {@code SerialClob}.
<i>616</i>&nbsp;     * @return  a hash code value for this object.
<b class="nc"><i>617</i>&nbsp;     */</b>
<i>618</i>&nbsp;    public int hashCode() {
<i>619</i>&nbsp;       return ((31 + Arrays.hashCode(buf)) * 31 + (int)len) * 31 + (int)origLen;
<i>620</i>&nbsp;    }
<i>621</i>&nbsp;
<i>622</i>&nbsp;    /**
<i>623</i>&nbsp;     * Returns a clone of this {@code SerialClob}. The copy will contain a
<i>624</i>&nbsp;     * reference to a clone of the internal character array, not a reference
<i>625</i>&nbsp;     * to the original internal character array of this {@code SerialClob} object.
<i>626</i>&nbsp;     * The underlying {@code Clob} object will be set to null.
<i>627</i>&nbsp;     *
<i>628</i>&nbsp;     * @return  a clone of this SerialClob
<i>629</i>&nbsp;     */
<b class="nc"><i>630</i>&nbsp;    public Object clone() {</b>
<b class="nc"><i>631</i>&nbsp;        try {</b>
<b class="nc"><i>632</i>&nbsp;            SerialClob sc = (SerialClob) super.clone();</b>
<b class="nc"><i>633</i>&nbsp;            sc.buf = (buf != null) ? Arrays.copyOf(buf, (int)len) : null;</b>
<b class="nc"><i>634</i>&nbsp;            sc.clob = null;</b>
<i>635</i>&nbsp;            return sc;
<b class="nc"><i>636</i>&nbsp;        } catch (CloneNotSupportedException ex) {</b>
<i>637</i>&nbsp;            // this shouldn&#39;t happen, since we are Cloneable
<i>638</i>&nbsp;            throw new InternalError();
<i>639</i>&nbsp;        }
<i>640</i>&nbsp;    }
<i>641</i>&nbsp;
<i>642</i>&nbsp;    /**
<i>643</i>&nbsp;     * readObject is called to restore the state of the SerialClob from
<i>644</i>&nbsp;     * a stream.
<i>645</i>&nbsp;     */
<i>646</i>&nbsp;    private void readObject(ObjectInputStream s)
<b class="nc"><i>647</i>&nbsp;            throws IOException, ClassNotFoundException {</b>
<b class="nc"><i>648</i>&nbsp;</b>
<b class="nc"><i>649</i>&nbsp;        ObjectInputStream.GetField fields = s.readFields();</b>
<b class="nc"><i>650</i>&nbsp;       char[] tmp = (char[])fields.get(&quot;buf&quot;, null);</b>
<b class="nc"><i>651</i>&nbsp;       if (tmp == null)</b>
<b class="nc"><i>652</i>&nbsp;           throw new InvalidObjectException(&quot;buf is null and should not be!&quot;);</b>
<b class="nc"><i>653</i>&nbsp;       buf = tmp.clone();</b>
<b class="nc"><i>654</i>&nbsp;       len = fields.get(&quot;len&quot;, 0L);</b>
<b class="nc"><i>655</i>&nbsp;       if (buf.length != len)</b>
<b class="nc"><i>656</i>&nbsp;           throw new InvalidObjectException(&quot;buf is not the expected size&quot;);</b>
<i>657</i>&nbsp;       origLen = fields.get(&quot;origLen&quot;, 0L);
<i>658</i>&nbsp;       clob = (Clob) fields.get(&quot;clob&quot;, null);
<i>659</i>&nbsp;    }
<i>660</i>&nbsp;
<i>661</i>&nbsp;    /**
<i>662</i>&nbsp;     * writeObject is called to save the state of the SerialClob
<i>663</i>&nbsp;     * to a stream.
<i>664</i>&nbsp;     */
<i>665</i>&nbsp;    private void writeObject(ObjectOutputStream s)
<b class="nc"><i>666</i>&nbsp;            throws IOException, ClassNotFoundException {</b>
<b class="nc"><i>667</i>&nbsp;</b>
<b class="nc"><i>668</i>&nbsp;        ObjectOutputStream.PutField fields = s.putFields();</b>
<b class="nc"><i>669</i>&nbsp;        fields.put(&quot;buf&quot;, buf);</b>
<i>670</i>&nbsp;        fields.put(&quot;len&quot;, len);
<i>671</i>&nbsp;        fields.put(&quot;origLen&quot;, origLen);
<b class="nc"><i>672</i>&nbsp;        // Note: this check to see if it is an instance of Serializable</b>
<b class="nc"><i>673</i>&nbsp;        // is for backwards compatibility</b>
<i>674</i>&nbsp;        fields.put(&quot;clob&quot;, clob instanceof Serializable ? clob : null);
<i>675</i>&nbsp;        s.writeFields();
<i>676</i>&nbsp;    }
<i>677</i>&nbsp;
<i>678</i>&nbsp;    /**
<i>679</i>&nbsp;     * Check to see if this object had previously had its {@code free} method
<i>680</i>&nbsp;     * called
<i>681</i>&nbsp;     *
<i>682</i>&nbsp;     * @throws SerialException
<b class="nc"><i>683</i>&nbsp;     */</b>
<b class="nc"><i>684</i>&nbsp;    private void isValid() throws SerialException {</b>
<i>685</i>&nbsp;        if (buf == null) {
<i>686</i>&nbsp;            throw new SerialException(&quot;Error: You cannot call a method on a &quot;
<i>687</i>&nbsp;                    + &quot;SerialClob instance once free() has been called.&quot;);
<i>688</i>&nbsp;        }
<i>689</i>&nbsp;    }
<i>690</i>&nbsp;
<i>691</i>&nbsp;    /**
<i>692</i>&nbsp;     * The identifier that assists in the serialization of this {@code SerialClob}
<i>693</i>&nbsp;     * object.
<i>694</i>&nbsp;     */
<i>695</i>&nbsp;    static final long serialVersionUID = -1662519690087375313L;
<i>696</i>&nbsp;}
</div>
</div>

<div class="footer">
    
    <div style="float:right;">generated on 2018-11-19 23:15</div>
</div>
</body>
</html>
