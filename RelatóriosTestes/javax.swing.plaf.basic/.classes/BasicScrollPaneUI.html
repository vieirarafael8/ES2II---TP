


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html id="htmlId">
<head>
  <title>Coverage Report :: BasicScrollPaneUI</title>
  <style type="text/css">
    @import "../../.css/coverage.css";
  </style>
</head>

<body>
<div class="header"></div>

<div class="content">
<div class="breadCrumbs">
    [ <a href="../../index.html">all classes</a> ]
    [ <a href="../index.html">javax.swing.plaf.basic</a> ]
</div>

<h1>Coverage Summary for Class: BasicScrollPaneUI (javax.swing.plaf.basic)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">BasicScrollPaneUI</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 33)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 235)
  </span>
</td>
</tr>
  <tr>
    <td class="name">BasicScrollPaneUI$Actions</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 5)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 70)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">BasicScrollPaneUI$Handler</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 8)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 153)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">BasicScrollPaneUI$HSBChangeListener</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">BasicScrollPaneUI$MouseWheelHandler</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">BasicScrollPaneUI$PropertyChangeHandler</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">BasicScrollPaneUI$ViewportChangeHandler</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">BasicScrollPaneUI$VSBChangeListener</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 2)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 56)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/ 468)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<div class="sourceCode"><i>1</i>&nbsp;/*
<i>2</i>&nbsp; * Copyright (c) 1997, 2016, Oracle and/or its affiliates. All rights reserved.
<i>3</i>&nbsp; * ORACLE PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.
<i>4</i>&nbsp; *
<i>5</i>&nbsp; *
<i>6</i>&nbsp; *
<i>7</i>&nbsp; *
<i>8</i>&nbsp; *
<i>9</i>&nbsp; *
<i>10</i>&nbsp; *
<i>11</i>&nbsp; *
<i>12</i>&nbsp; *
<i>13</i>&nbsp; *
<i>14</i>&nbsp; *
<i>15</i>&nbsp; *
<i>16</i>&nbsp; *
<i>17</i>&nbsp; *
<i>18</i>&nbsp; *
<i>19</i>&nbsp; *
<i>20</i>&nbsp; *
<i>21</i>&nbsp; *
<i>22</i>&nbsp; *
<i>23</i>&nbsp; *
<i>24</i>&nbsp; */
<i>25</i>&nbsp;
<i>26</i>&nbsp;package javax.swing.plaf.basic;
<i>27</i>&nbsp;
<i>28</i>&nbsp;import sun.swing.DefaultLookup;
<i>29</i>&nbsp;import sun.swing.UIAction;
<i>30</i>&nbsp;
<i>31</i>&nbsp;import javax.swing.*;
<i>32</i>&nbsp;import javax.swing.event.*;
<i>33</i>&nbsp;import javax.swing.border.*;
<i>34</i>&nbsp;import javax.swing.plaf.*;
<i>35</i>&nbsp;
<i>36</i>&nbsp;import java.beans.PropertyChangeListener;
<i>37</i>&nbsp;import java.beans.PropertyChangeEvent;
<i>38</i>&nbsp;
<i>39</i>&nbsp;import java.awt.Component;
<i>40</i>&nbsp;import java.awt.Rectangle;
<i>41</i>&nbsp;import java.awt.Dimension;
<i>42</i>&nbsp;import java.awt.Point;
<i>43</i>&nbsp;import java.awt.Insets;
<i>44</i>&nbsp;import java.awt.Graphics;
<i>45</i>&nbsp;import java.awt.event.*;
<i>46</i>&nbsp;
<i>47</i>&nbsp;/**
<i>48</i>&nbsp; * A default L&amp;amp;F implementation of ScrollPaneUI.
<i>49</i>&nbsp; *
<i>50</i>&nbsp; * @author Hans Muller
<i>51</i>&nbsp; */
<b class="nc"><i>52</i>&nbsp;public class BasicScrollPaneUI</b>
<i>53</i>&nbsp;    extends ScrollPaneUI implements ScrollPaneConstants
<i>54</i>&nbsp;{
<i>55</i>&nbsp;    /**
<i>56</i>&nbsp;     * The instance of {@code JScrollPane}.
<i>57</i>&nbsp;     */
<i>58</i>&nbsp;    protected JScrollPane scrollpane;
<i>59</i>&nbsp;
<i>60</i>&nbsp;    /**
<b class="nc"><i>61</i>&nbsp;     * {@code ChangeListener} installed on the vertical scrollbar.</b>
<i>62</i>&nbsp;     */
<i>63</i>&nbsp;    protected ChangeListener vsbChangeListener;
<i>64</i>&nbsp;
<i>65</i>&nbsp;    /**
<i>66</i>&nbsp;     * {@code ChangeListener} installed on the horizontal scrollbar.
<i>67</i>&nbsp;     */
<i>68</i>&nbsp;    protected ChangeListener hsbChangeListener;
<i>69</i>&nbsp;
<i>70</i>&nbsp;    /**
<i>71</i>&nbsp;     * {@code ChangeListener} installed on the viewport.
<i>72</i>&nbsp;     */
<i>73</i>&nbsp;    protected ChangeListener viewportChangeListener;
<i>74</i>&nbsp;
<i>75</i>&nbsp;    /**
<i>76</i>&nbsp;     * {@code PropertyChangeListener} installed on the scroll pane.
<i>77</i>&nbsp;     */
<i>78</i>&nbsp;    protected PropertyChangeListener spPropertyChangeListener;
<i>79</i>&nbsp;    private MouseWheelListener mouseScrollListener;
<b class="nc"><i>80</i>&nbsp;    private int oldExtent = Integer.MIN_VALUE;</b>
<i>81</i>&nbsp;
<i>82</i>&nbsp;    /**
<i>83</i>&nbsp;     * {@code PropertyChangeListener} installed on the vertical scrollbar.
<b class="nc"><i>84</i>&nbsp;     */</b>
<i>85</i>&nbsp;    private PropertyChangeListener vsbPropertyChangeListener;
<i>86</i>&nbsp;
<i>87</i>&nbsp;    /**
<b class="nc"><i>88</i>&nbsp;     * {@code PropertyChangeListener} installed on the horizontal scrollbar.</b>
<b class="nc"><i>89</i>&nbsp;     */</b>
<b class="nc"><i>90</i>&nbsp;    private PropertyChangeListener hsbPropertyChangeListener;</b>
<b class="nc"><i>91</i>&nbsp;</b>
<b class="nc"><i>92</i>&nbsp;    private Handler handler;</b>
<b class="nc"><i>93</i>&nbsp;</b>
<b class="nc"><i>94</i>&nbsp;    /**</b>
<b class="nc"><i>95</i>&nbsp;     * State flag that shows whether setValue() was called from a user program</b>
<b class="nc"><i>96</i>&nbsp;     * before the value of &quot;extent&quot; was set in right-to-left component</b>
<b class="nc"><i>97</i>&nbsp;     * orientation.</b>
<i>98</i>&nbsp;     */
<i>99</i>&nbsp;    private boolean setValueCalled = false;
<i>100</i>&nbsp;
<i>101</i>&nbsp;    /**
<i>102</i>&nbsp;     * Returns a new instance of {@code BasicScrollPaneUI}.
<b class="nc"><i>103</i>&nbsp;     *</b>
<b class="nc"><i>104</i>&nbsp;     * @param x a component.</b>
<b class="nc"><i>105</i>&nbsp;     * @return a new instance of {@code BasicScrollPaneUI}</b>
<b class="nc"><i>106</i>&nbsp;     */</b>
<i>107</i>&nbsp;    public static ComponentUI createUI(JComponent x) {
<i>108</i>&nbsp;        return new BasicScrollPaneUI();
<i>109</i>&nbsp;    }
<i>110</i>&nbsp;
<i>111</i>&nbsp;    static void loadActionMap(LazyActionMap map) {
<i>112</i>&nbsp;        map.put(new Actions(Actions.SCROLL_UP));
<i>113</i>&nbsp;        map.put(new Actions(Actions.SCROLL_DOWN));
<i>114</i>&nbsp;        map.put(new Actions(Actions.SCROLL_HOME));
<b class="nc"><i>115</i>&nbsp;        map.put(new Actions(Actions.SCROLL_END));</b>
<i>116</i>&nbsp;        map.put(new Actions(Actions.UNIT_SCROLL_UP));
<i>117</i>&nbsp;        map.put(new Actions(Actions.UNIT_SCROLL_DOWN));
<i>118</i>&nbsp;        map.put(new Actions(Actions.SCROLL_LEFT));
<i>119</i>&nbsp;        map.put(new Actions(Actions.SCROLL_RIGHT));
<i>120</i>&nbsp;        map.put(new Actions(Actions.UNIT_SCROLL_RIGHT));
<b class="nc"><i>121</i>&nbsp;        map.put(new Actions(Actions.UNIT_SCROLL_LEFT));</b>
<b class="nc"><i>122</i>&nbsp;    }</b>
<i>123</i>&nbsp;
<i>124</i>&nbsp;
<i>125</i>&nbsp;
<i>126</i>&nbsp;    public void paint(Graphics g, JComponent c) {
<b class="nc"><i>127</i>&nbsp;        Border vpBorder = scrollpane.getViewportBorder();</b>
<b class="nc"><i>128</i>&nbsp;        if (vpBorder != null) {</b>
<b class="nc"><i>129</i>&nbsp;            Rectangle r = scrollpane.getViewportBorderBounds();</b>
<b class="nc"><i>130</i>&nbsp;            vpBorder.paintBorder(scrollpane, g, r.x, r.y, r.width, r.height);</b>
<i>131</i>&nbsp;        }
<b class="nc"><i>132</i>&nbsp;    }</b>
<i>133</i>&nbsp;
<i>134</i>&nbsp;
<i>135</i>&nbsp;    /**
<i>136</i>&nbsp;     * @return new Dimension(Short.MAX_VALUE, Short.MAX_VALUE)
<i>137</i>&nbsp;     */
<b class="nc"><i>138</i>&nbsp;    public Dimension getMaximumSize(JComponent c) {</b>
<b class="nc"><i>139</i>&nbsp;        return new Dimension(Short.MAX_VALUE, Short.MAX_VALUE);</b>
<b class="nc"><i>140</i>&nbsp;    }</b>
<b class="nc"><i>141</i>&nbsp;</b>
<b class="nc"><i>142</i>&nbsp;    /**</b>
<b class="nc"><i>143</i>&nbsp;     * Installs default properties.</b>
<i>144</i>&nbsp;     *
<b class="nc"><i>145</i>&nbsp;     * @param scrollpane an instance of {@code JScrollPane}</b>
<b class="nc"><i>146</i>&nbsp;     */</b>
<b class="nc"><i>147</i>&nbsp;    protected void installDefaults(JScrollPane scrollpane)</b>
<i>148</i>&nbsp;    {
<b class="nc"><i>149</i>&nbsp;        LookAndFeel.installBorder(scrollpane, &quot;ScrollPane.border&quot;);</b>
<b class="nc"><i>150</i>&nbsp;        LookAndFeel.installColorsAndFont(scrollpane,</b>
<i>151</i>&nbsp;            &quot;ScrollPane.background&quot;,
<b class="nc"><i>152</i>&nbsp;            &quot;ScrollPane.foreground&quot;,</b>
<b class="nc"><i>153</i>&nbsp;            &quot;ScrollPane.font&quot;);</b>
<b class="nc"><i>154</i>&nbsp;</b>
<i>155</i>&nbsp;        Border vpBorder = scrollpane.getViewportBorder();
<b class="nc"><i>156</i>&nbsp;        if ((vpBorder == null) ||( vpBorder instanceof UIResource)) {</b>
<b class="nc"><i>157</i>&nbsp;            vpBorder = UIManager.getBorder(&quot;ScrollPane.viewportBorder&quot;);</b>
<b class="nc"><i>158</i>&nbsp;            scrollpane.setViewportBorder(vpBorder);</b>
<i>159</i>&nbsp;        }
<i>160</i>&nbsp;        LookAndFeel.installProperty(scrollpane, &quot;opaque&quot;, Boolean.TRUE);
<b class="nc"><i>161</i>&nbsp;    }</b>
<i>162</i>&nbsp;
<b class="nc"><i>163</i>&nbsp;    /**</b>
<b class="nc"><i>164</i>&nbsp;     * Registers listeners.</b>
<i>165</i>&nbsp;     *
<i>166</i>&nbsp;     * @param c an instance of {@code JScrollPane}
<i>167</i>&nbsp;     */
<i>168</i>&nbsp;    protected void installListeners(JScrollPane c)
<b class="nc"><i>169</i>&nbsp;    {</b>
<i>170</i>&nbsp;        vsbChangeListener = createVSBChangeListener();
<i>171</i>&nbsp;        vsbPropertyChangeListener = createVSBPropertyChangeListener();
<b class="nc"><i>172</i>&nbsp;        hsbChangeListener = createHSBChangeListener();</b>
<i>173</i>&nbsp;        hsbPropertyChangeListener = createHSBPropertyChangeListener();
<i>174</i>&nbsp;        viewportChangeListener = createViewportChangeListener();
<b class="nc"><i>175</i>&nbsp;        spPropertyChangeListener = createPropertyChangeListener();</b>
<i>176</i>&nbsp;
<i>177</i>&nbsp;        JViewport viewport = scrollpane.getViewport();
<i>178</i>&nbsp;        JScrollBar vsb = scrollpane.getVerticalScrollBar();
<i>179</i>&nbsp;        JScrollBar hsb = scrollpane.getHorizontalScrollBar();
<b class="nc"><i>180</i>&nbsp;</b>
<b class="nc"><i>181</i>&nbsp;        if (viewport != null) {</b>
<i>182</i>&nbsp;            viewport.addChangeListener(viewportChangeListener);
<i>183</i>&nbsp;        }
<i>184</i>&nbsp;        if (vsb != null) {
<b class="nc"><i>185</i>&nbsp;            vsb.getModel().addChangeListener(vsbChangeListener);</b>
<b class="nc"><i>186</i>&nbsp;            vsb.addPropertyChangeListener(vsbPropertyChangeListener);</b>
<i>187</i>&nbsp;        }
<b class="nc"><i>188</i>&nbsp;        if (hsb != null) {</b>
<i>189</i>&nbsp;            hsb.getModel().addChangeListener(hsbChangeListener);
<b class="nc"><i>190</i>&nbsp;            hsb.addPropertyChangeListener(hsbPropertyChangeListener);</b>
<b class="nc"><i>191</i>&nbsp;        }</b>
<i>192</i>&nbsp;
<i>193</i>&nbsp;        scrollpane.addPropertyChangeListener(spPropertyChangeListener);
<b class="nc"><i>194</i>&nbsp;</b>
<i>195</i>&nbsp;    mouseScrollListener = createMouseWheelListener();
<i>196</i>&nbsp;    scrollpane.addMouseWheelListener(mouseScrollListener);
<i>197</i>&nbsp;
<b class="nc"><i>198</i>&nbsp;    }</b>
<b class="nc"><i>199</i>&nbsp;</b>
<b class="nc"><i>200</i>&nbsp;    /**</b>
<b class="nc"><i>201</i>&nbsp;     * Registers keyboard actions.</b>
<i>202</i>&nbsp;     *
<i>203</i>&nbsp;     * @param c an instance of {@code JScrollPane}
<i>204</i>&nbsp;     */
<i>205</i>&nbsp;    protected void installKeyboardActions(JScrollPane c) {
<b class="nc"><i>206</i>&nbsp;        InputMap inputMap = getInputMap(JComponent.</b>
<i>207</i>&nbsp;                                  WHEN_ANCESTOR_OF_FOCUSED_COMPONENT);
<b class="nc"><i>208</i>&nbsp;</b>
<b class="nc"><i>209</i>&nbsp;        SwingUtilities.replaceUIInputMap(c, JComponent.</b>
<i>210</i>&nbsp;                               WHEN_ANCESTOR_OF_FOCUSED_COMPONENT, inputMap);
<i>211</i>&nbsp;
<i>212</i>&nbsp;        LazyActionMap.installLazyActionMap(c, BasicScrollPaneUI.class,
<i>213</i>&nbsp;                                           &quot;ScrollPane.actionMap&quot;);
<i>214</i>&nbsp;    }
<b class="nc"><i>215</i>&nbsp;</b>
<b class="nc"><i>216</i>&nbsp;    InputMap getInputMap(int condition) {</b>
<b class="nc"><i>217</i>&nbsp;        if (condition == JComponent.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT) {</b>
<i>218</i>&nbsp;            InputMap keyMap = (InputMap)DefaultLookup.get(scrollpane, this,
<b class="nc"><i>219</i>&nbsp;                                        &quot;ScrollPane.ancestorInputMap&quot;);</b>
<b class="nc"><i>220</i>&nbsp;            InputMap rtlKeyMap;</b>
<i>221</i>&nbsp;
<b class="nc"><i>222</i>&nbsp;            if (scrollpane.getComponentOrientation().isLeftToRight() ||</b>
<b class="nc"><i>223</i>&nbsp;                    ((rtlKeyMap = (InputMap)DefaultLookup.get(scrollpane, this,</b>
<b class="nc"><i>224</i>&nbsp;                    &quot;ScrollPane.ancestorInputMap.RightToLeft&quot;)) == null)) {</b>
<i>225</i>&nbsp;                return keyMap;
<b class="nc"><i>226</i>&nbsp;            } else {</b>
<b class="nc"><i>227</i>&nbsp;                rtlKeyMap.setParent(keyMap);</b>
<b class="nc"><i>228</i>&nbsp;                return rtlKeyMap;</b>
<i>229</i>&nbsp;            }
<i>230</i>&nbsp;        }
<b class="nc"><i>231</i>&nbsp;        return null;</b>
<i>232</i>&nbsp;    }
<b class="nc"><i>233</i>&nbsp;</b>
<b class="nc"><i>234</i>&nbsp;    public void installUI(JComponent x) {</b>
<i>235</i>&nbsp;        scrollpane = (JScrollPane)x;
<i>236</i>&nbsp;        installDefaults(scrollpane);
<b class="nc"><i>237</i>&nbsp;        installListeners(scrollpane);</b>
<b class="nc"><i>238</i>&nbsp;        installKeyboardActions(scrollpane);</b>
<b class="nc"><i>239</i>&nbsp;    }</b>
<b class="nc"><i>240</i>&nbsp;</b>
<b class="nc"><i>241</i>&nbsp;    /**</b>
<b class="nc"><i>242</i>&nbsp;     * Uninstalls default properties.</b>
<i>243</i>&nbsp;     *
<i>244</i>&nbsp;     * @param c an instance of {@code JScrollPane}
<i>245</i>&nbsp;     */
<i>246</i>&nbsp;    protected void uninstallDefaults(JScrollPane c) {
<b class="nc"><i>247</i>&nbsp;        LookAndFeel.uninstallBorder(scrollpane);</b>
<b class="nc"><i>248</i>&nbsp;</b>
<i>249</i>&nbsp;        if (scrollpane.getViewportBorder() instanceof UIResource) {
<i>250</i>&nbsp;            scrollpane.setViewportBorder(null);
<i>251</i>&nbsp;        }
<i>252</i>&nbsp;    }
<i>253</i>&nbsp;
<b class="nc"><i>254</i>&nbsp;    /**</b>
<b class="nc"><i>255</i>&nbsp;     * Unregisters listeners.</b>
<b class="nc"><i>256</i>&nbsp;     *</b>
<b class="nc"><i>257</i>&nbsp;     * @param c a component</b>
<i>258</i>&nbsp;     */
<i>259</i>&nbsp;    protected void uninstallListeners(JComponent c) {
<i>260</i>&nbsp;        JViewport viewport = scrollpane.getViewport();
<b class="nc"><i>261</i>&nbsp;        JScrollBar vsb = scrollpane.getVerticalScrollBar();</b>
<b class="nc"><i>262</i>&nbsp;        JScrollBar hsb = scrollpane.getHorizontalScrollBar();</b>
<i>263</i>&nbsp;
<b class="nc"><i>264</i>&nbsp;        if (viewport != null) {</b>
<i>265</i>&nbsp;            viewport.removeChangeListener(viewportChangeListener);
<i>266</i>&nbsp;        }
<i>267</i>&nbsp;        if (vsb != null) {
<i>268</i>&nbsp;            vsb.getModel().removeChangeListener(vsbChangeListener);
<b class="nc"><i>269</i>&nbsp;            vsb.removePropertyChangeListener(vsbPropertyChangeListener);</b>
<b class="nc"><i>270</i>&nbsp;        }</b>
<b class="nc"><i>271</i>&nbsp;        if (hsb != null) {</b>
<b class="nc"><i>272</i>&nbsp;            hsb.getModel().removeChangeListener(hsbChangeListener);</b>
<b class="nc"><i>273</i>&nbsp;            hsb.removePropertyChangeListener(hsbPropertyChangeListener);</b>
<b class="nc"><i>274</i>&nbsp;        }</b>
<i>275</i>&nbsp;
<b class="nc"><i>276</i>&nbsp;        scrollpane.removePropertyChangeListener(spPropertyChangeListener);</b>
<b class="nc"><i>277</i>&nbsp;</b>
<b class="nc"><i>278</i>&nbsp;    if (mouseScrollListener != null) {</b>
<b class="nc"><i>279</i>&nbsp;        scrollpane.removeMouseWheelListener(mouseScrollListener);</b>
<i>280</i>&nbsp;    }
<b class="nc"><i>281</i>&nbsp;</b>
<b class="nc"><i>282</i>&nbsp;        vsbChangeListener = null;</b>
<b class="nc"><i>283</i>&nbsp;        hsbChangeListener = null;</b>
<b class="nc"><i>284</i>&nbsp;        viewportChangeListener = null;</b>
<b class="nc"><i>285</i>&nbsp;        spPropertyChangeListener = null;</b>
<i>286</i>&nbsp;        mouseScrollListener = null;
<i>287</i>&nbsp;        handler = null;
<b class="nc"><i>288</i>&nbsp;    }</b>
<b class="nc"><i>289</i>&nbsp;</b>
<b class="nc"><i>290</i>&nbsp;    /**</b>
<i>291</i>&nbsp;     * Unregisters keyboard actions.
<i>292</i>&nbsp;     *
<b class="nc"><i>293</i>&nbsp;     * @param c an instance of {@code JScrollPane}</b>
<b class="nc"><i>294</i>&nbsp;     */</b>
<i>295</i>&nbsp;    protected void uninstallKeyboardActions(JScrollPane c) {
<b class="nc"><i>296</i>&nbsp;        SwingUtilities.replaceUIActionMap(c, null);</b>
<i>297</i>&nbsp;        SwingUtilities.replaceUIInputMap(c, JComponent.
<i>298</i>&nbsp;                           WHEN_ANCESTOR_OF_FOCUSED_COMPONENT, null);
<i>299</i>&nbsp;    }
<i>300</i>&nbsp;
<b class="nc"><i>301</i>&nbsp;</b>
<b class="nc"><i>302</i>&nbsp;    public void uninstallUI(JComponent c) {</b>
<i>303</i>&nbsp;        uninstallDefaults(scrollpane);
<i>304</i>&nbsp;        uninstallListeners(scrollpane);
<b class="nc"><i>305</i>&nbsp;        uninstallKeyboardActions(scrollpane);</b>
<b class="nc"><i>306</i>&nbsp;        scrollpane = null;</b>
<i>307</i>&nbsp;    }
<i>308</i>&nbsp;
<b class="nc"><i>309</i>&nbsp;    private Handler getHandler() {</b>
<b class="nc"><i>310</i>&nbsp;        if (handler == null) {</b>
<b class="nc"><i>311</i>&nbsp;            handler = new Handler();</b>
<b class="nc"><i>312</i>&nbsp;        }</b>
<i>313</i>&nbsp;        return handler;
<i>314</i>&nbsp;    }
<i>315</i>&nbsp;
<i>316</i>&nbsp;    /**
<i>317</i>&nbsp;     * Synchronizes the {@code JScrollPane} with {@code Viewport}.
<i>318</i>&nbsp;     */
<i>319</i>&nbsp;    protected void syncScrollPaneWithViewport()
<i>320</i>&nbsp;    {
<i>321</i>&nbsp;        JViewport viewport = scrollpane.getViewport();
<i>322</i>&nbsp;        JScrollBar vsb = scrollpane.getVerticalScrollBar();
<i>323</i>&nbsp;        JScrollBar hsb = scrollpane.getHorizontalScrollBar();
<i>324</i>&nbsp;        JViewport rowHead = scrollpane.getRowHeader();
<b class="nc"><i>325</i>&nbsp;        JViewport colHead = scrollpane.getColumnHeader();</b>
<b class="nc"><i>326</i>&nbsp;        boolean ltr = scrollpane.getComponentOrientation().isLeftToRight();</b>
<b class="nc"><i>327</i>&nbsp;</b>
<i>328</i>&nbsp;        if (viewport != null) {
<i>329</i>&nbsp;            Dimension extentSize = viewport.getExtentSize();
<i>330</i>&nbsp;            Dimension viewSize = viewport.getViewSize();
<i>331</i>&nbsp;            Point viewPosition = viewport.getViewPosition();
<b class="nc"><i>332</i>&nbsp;</b>
<b class="nc"><i>333</i>&nbsp;            if (vsb != null) {</b>
<i>334</i>&nbsp;                int extent = extentSize.height;
<i>335</i>&nbsp;                int max = viewSize.height;
<b class="nc"><i>336</i>&nbsp;                int value = Math.max(0, Math.min(viewPosition.y, max - extent));</b>
<b class="nc"><i>337</i>&nbsp;                vsb.setValues(value, extent, 0, max);</b>
<b class="nc"><i>338</i>&nbsp;            }</b>
<b class="nc"><i>339</i>&nbsp;</b>
<b class="nc"><i>340</i>&nbsp;            if (hsb != null) {</b>
<i>341</i>&nbsp;                int extent = extentSize.width;
<i>342</i>&nbsp;                int max = viewSize.width;
<b class="nc"><i>343</i>&nbsp;                int value;</b>
<b class="nc"><i>344</i>&nbsp;</b>
<b class="nc"><i>345</i>&nbsp;                if (ltr) {</b>
<b class="nc"><i>346</i>&nbsp;                    value = Math.max(0, Math.min(viewPosition.x, max - extent));</b>
<i>347</i>&nbsp;                } else {
<b class="nc"><i>348</i>&nbsp;                    int currentValue = hsb.getValue();</b>
<i>349</i>&nbsp;
<b class="nc"><i>350</i>&nbsp;                    /* Use a particular formula to calculate &quot;value&quot;</b>
<b class="nc"><i>351</i>&nbsp;                     * until effective x coordinate is calculated.</b>
<i>352</i>&nbsp;                     */
<i>353</i>&nbsp;                    if (setValueCalled &amp;&amp; ((max - currentValue) == viewPosition.x)) {
<i>354</i>&nbsp;                        value = Math.max(0, Math.min(max - extent, currentValue));
<i>355</i>&nbsp;                        /* After &quot;extent&quot; is set, turn setValueCalled flag off.
<i>356</i>&nbsp;                         */
<i>357</i>&nbsp;                        if (extent != 0) {
<i>358</i>&nbsp;                            setValueCalled = false;
<i>359</i>&nbsp;                        }
<i>360</i>&nbsp;                    } else {
<i>361</i>&nbsp;                        if (extent &gt; max) {
<i>362</i>&nbsp;                            viewPosition.x = max - extent;
<i>363</i>&nbsp;                            viewport.setViewPosition(viewPosition);
<i>364</i>&nbsp;                            value = 0;
<b class="nc"><i>365</i>&nbsp;                        } else {</b>
<b class="nc"><i>366</i>&nbsp;                           /* The following line can&#39;t handle a small value of</b>
<i>367</i>&nbsp;                            * viewPosition.x like Integer.MIN_VALUE correctly
<i>368</i>&nbsp;                            * because (max - extent - viewPositoiin.x) causes
<b class="nc"><i>369</i>&nbsp;                            * an overflow. As a result, value becomes zero.</b>
<b class="nc"><i>370</i>&nbsp;                            * (e.g. setViewPosition(Integer.MAX_VALUE, ...)</b>
<i>371</i>&nbsp;                            *       in a user program causes a overflow.
<i>372</i>&nbsp;                            *       Its expected value is (max - extent).)
<b class="nc"><i>373</i>&nbsp;                            * However, this seems a trivial bug and adding a</b>
<b class="nc"><i>374</i>&nbsp;                            * fix makes this often-called method slow, so I&#39;ll</b>
<b class="nc"><i>375</i>&nbsp;                            * leave it until someone claims.</b>
<b class="nc"><i>376</i>&nbsp;                            */</b>
<b class="nc"><i>377</i>&nbsp;                            value = Math.max(0, Math.min(max - extent, max - extent - viewPosition.x));</b>
<b class="nc"><i>378</i>&nbsp;                            if (oldExtent &gt; extent) {</b>
<b class="nc"><i>379</i>&nbsp;                                value -= oldExtent - extent;</b>
<b class="nc"><i>380</i>&nbsp;                            }</b>
<b class="nc"><i>381</i>&nbsp;                        }</b>
<i>382</i>&nbsp;                    }
<b class="nc"><i>383</i>&nbsp;                }</b>
<b class="nc"><i>384</i>&nbsp;                oldExtent = extent;</b>
<i>385</i>&nbsp;                hsb.setValues(value, extent, 0, max);
<b class="nc"><i>386</i>&nbsp;            }</b>
<b class="nc"><i>387</i>&nbsp;</b>
<i>388</i>&nbsp;            if (rowHead != null) {
<i>389</i>&nbsp;                Point p = rowHead.getViewPosition();
<b class="nc"><i>390</i>&nbsp;                p.y = viewport.getViewPosition().y;</b>
<b class="nc"><i>391</i>&nbsp;                p.x = 0;</b>
<b class="nc"><i>392</i>&nbsp;                rowHead.setViewPosition(p);</b>
<i>393</i>&nbsp;            }
<b class="nc"><i>394</i>&nbsp;</b>
<b class="nc"><i>395</i>&nbsp;            if (colHead != null) {</b>
<b class="nc"><i>396</i>&nbsp;                Point p = colHead.getViewPosition();</b>
<i>397</i>&nbsp;                if (ltr) {
<b class="nc"><i>398</i>&nbsp;                    p.x = viewport.getViewPosition().x;</b>
<b class="nc"><i>399</i>&nbsp;                } else {</b>
<b class="nc"><i>400</i>&nbsp;                    p.x = Math.max(0, viewport.getViewPosition().x);</b>
<b class="nc"><i>401</i>&nbsp;                }</b>
<b class="nc"><i>402</i>&nbsp;                p.y = 0;</b>
<b class="nc"><i>403</i>&nbsp;                colHead.setViewPosition(p);</b>
<i>404</i>&nbsp;            }
<b class="nc"><i>405</i>&nbsp;        }</b>
<b class="nc"><i>406</i>&nbsp;    }</b>
<b class="nc"><i>407</i>&nbsp;</b>
<b class="nc"><i>408</i>&nbsp;    /**</b>
<i>409</i>&nbsp;     * Returns the baseline.
<b class="nc"><i>410</i>&nbsp;     *</b>
<b class="nc"><i>411</i>&nbsp;     * @throws NullPointerException {@inheritDoc}</b>
<b class="nc"><i>412</i>&nbsp;     * @throws IllegalArgumentException {@inheritDoc}</b>
<b class="nc"><i>413</i>&nbsp;     * @see javax.swing.JComponent#getBaseline(int, int)</b>
<i>414</i>&nbsp;     * @since 1.6
<i>415</i>&nbsp;     */
<i>416</i>&nbsp;    public int getBaseline(JComponent c, int width, int height) {
<b class="nc"><i>417</i>&nbsp;        if (c == null) {</b>
<i>418</i>&nbsp;            throw new NullPointerException(&quot;Component must be non-null&quot;);
<i>419</i>&nbsp;        }
<i>420</i>&nbsp;
<i>421</i>&nbsp;        if (width &lt; 0 || height &lt; 0) {
<i>422</i>&nbsp;            throw new IllegalArgumentException(&quot;Width and height must be &gt;= 0&quot;);
<i>423</i>&nbsp;        }
<i>424</i>&nbsp;
<i>425</i>&nbsp;        JViewport viewport = scrollpane.getViewport();
<i>426</i>&nbsp;        Insets spInsets = scrollpane.getInsets();
<i>427</i>&nbsp;        int y = spInsets.top;
<i>428</i>&nbsp;        height = height - spInsets.top - spInsets.bottom;
<i>429</i>&nbsp;        width = width - spInsets.left - spInsets.right;
<b class="nc"><i>430</i>&nbsp;        JViewport columnHeader = scrollpane.getColumnHeader();</b>
<i>431</i>&nbsp;        if (columnHeader != null &amp;&amp; columnHeader.isVisible()) {
<i>432</i>&nbsp;            Component header = columnHeader.getView();
<i>433</i>&nbsp;            if (header != null &amp;&amp; header.isVisible()) {
<i>434</i>&nbsp;                // Header is always given it&#39;s preferred size.
<i>435</i>&nbsp;                Dimension headerPref = header.getPreferredSize();
<b class="nc"><i>436</i>&nbsp;                int baseline = header.getBaseline(headerPref.width,</b>
<i>437</i>&nbsp;                                                  headerPref.height);
<i>438</i>&nbsp;                if (baseline &gt;= 0) {
<i>439</i>&nbsp;                    return y + baseline;
<i>440</i>&nbsp;                }
<i>441</i>&nbsp;            }
<i>442</i>&nbsp;            Dimension columnPref = columnHeader.getPreferredSize();
<b class="nc"><i>443</i>&nbsp;            height -= columnPref.height;</b>
<i>444</i>&nbsp;            y += columnPref.height;
<i>445</i>&nbsp;        }
<i>446</i>&nbsp;        Component view = (viewport == null) ? null : viewport.getView();
<i>447</i>&nbsp;        if (view != null &amp;&amp; view.isVisible() &amp;&amp;
<i>448</i>&nbsp;                view.getBaselineResizeBehavior() ==
<i>449</i>&nbsp;                Component.BaselineResizeBehavior.CONSTANT_ASCENT) {
<i>450</i>&nbsp;            Border viewportBorder = scrollpane.getViewportBorder();
<i>451</i>&nbsp;            if (viewportBorder != null) {
<b class="nc"><i>452</i>&nbsp;                Insets vpbInsets = viewportBorder.getBorderInsets(scrollpane);</b>
<i>453</i>&nbsp;                y += vpbInsets.top;
<i>454</i>&nbsp;                height = height - vpbInsets.top - vpbInsets.bottom;
<i>455</i>&nbsp;                width = width - vpbInsets.left - vpbInsets.right;
<i>456</i>&nbsp;            }
<b class="nc"><i>457</i>&nbsp;            if (view.getWidth() &gt; 0 &amp;&amp; view.getHeight() &gt; 0) {</b>
<i>458</i>&nbsp;                Dimension min = view.getMinimumSize();
<i>459</i>&nbsp;                width = Math.max(min.width, view.getWidth());
<i>460</i>&nbsp;                height = Math.max(min.height, view.getHeight());
<i>461</i>&nbsp;            }
<i>462</i>&nbsp;            if (width &gt; 0 &amp;&amp; height &gt; 0) {
<i>463</i>&nbsp;                int baseline = view.getBaseline(width, height);
<b class="nc"><i>464</i>&nbsp;                if (baseline &gt; 0) {</b>
<i>465</i>&nbsp;                    return y + baseline;
<i>466</i>&nbsp;                }
<i>467</i>&nbsp;            }
<i>468</i>&nbsp;        }
<i>469</i>&nbsp;        return -1;
<i>470</i>&nbsp;    }
<i>471</i>&nbsp;
<i>472</i>&nbsp;    /**
<i>473</i>&nbsp;     * Returns an enum indicating how the baseline of the component
<b class="nc"><i>474</i>&nbsp;     * changes as the size changes.</b>
<i>475</i>&nbsp;     *
<i>476</i>&nbsp;     * @throws NullPointerException {@inheritDoc}
<i>477</i>&nbsp;     * @see javax.swing.JComponent#getBaseline(int, int)
<i>478</i>&nbsp;     * @since 1.6
<i>479</i>&nbsp;     */
<i>480</i>&nbsp;    public Component.BaselineResizeBehavior getBaselineResizeBehavior(
<i>481</i>&nbsp;            JComponent c) {
<i>482</i>&nbsp;        super.getBaselineResizeBehavior(c);
<b class="nc"><i>483</i>&nbsp;        // Baseline is either from the header, in which case it&#39;s always</b>
<i>484</i>&nbsp;        // the same size and therefor can be created as CONSTANT_ASCENT.
<i>485</i>&nbsp;        // If the header doesn&#39;t have a baseline than the baseline will only
<i>486</i>&nbsp;        // be valid if it&#39;s BaselineResizeBehavior is
<b class="nc"><i>487</i>&nbsp;        // CONSTANT_ASCENT, so, return CONSTANT_ASCENT.</b>
<i>488</i>&nbsp;        return Component.BaselineResizeBehavior.CONSTANT_ASCENT;
<i>489</i>&nbsp;    }
<i>490</i>&nbsp;
<i>491</i>&nbsp;
<i>492</i>&nbsp;    /**
<i>493</i>&nbsp;     * Listener for viewport events.
<b class="nc"><i>494</i>&nbsp;     */</b>
<i>495</i>&nbsp;    public class ViewportChangeHandler implements ChangeListener
<i>496</i>&nbsp;    {
<i>497</i>&nbsp;
<i>498</i>&nbsp;        // NOTE: This class exists only for backward compatibility. All
<i>499</i>&nbsp;        // its functionality has been moved into Handler. If you need to add
<i>500</i>&nbsp;        // new functionality add it to the Handler, but make sure this
<i>501</i>&nbsp;        // class calls into the Handler.
<i>502</i>&nbsp;
<i>503</i>&nbsp;        public void stateChanged(ChangeEvent e) {
<b class="nc"><i>504</i>&nbsp;            getHandler().stateChanged(e);</b>
<i>505</i>&nbsp;        }
<i>506</i>&nbsp;    }
<i>507</i>&nbsp;
<i>508</i>&nbsp;    /**
<i>509</i>&nbsp;     * Returns an instance of viewport {@code ChangeListener}.
<i>510</i>&nbsp;     *
<i>511</i>&nbsp;     * @return an instance of viewport {@code ChangeListener}
<i>512</i>&nbsp;     */
<i>513</i>&nbsp;    protected ChangeListener createViewportChangeListener() {
<b class="nc"><i>514</i>&nbsp;        return getHandler();</b>
<i>515</i>&nbsp;    }
<i>516</i>&nbsp;
<i>517</i>&nbsp;
<b class="nc"><i>518</i>&nbsp;    /**</b>
<i>519</i>&nbsp;     * Horizontal scrollbar listener.
<i>520</i>&nbsp;     */
<i>521</i>&nbsp;    public class HSBChangeListener implements ChangeListener
<i>522</i>&nbsp;    {
<i>523</i>&nbsp;
<i>524</i>&nbsp;        // NOTE: This class exists only for backward compatibility. All
<i>525</i>&nbsp;        // its functionality has been moved into Handler. If you need to add
<i>526</i>&nbsp;        // new functionality add it to the Handler, but make sure this
<i>527</i>&nbsp;        // class calls into the Handler.
<i>528</i>&nbsp;
<i>529</i>&nbsp;        public void stateChanged(ChangeEvent e)
<i>530</i>&nbsp;        {
<i>531</i>&nbsp;            getHandler().stateChanged(e);
<i>532</i>&nbsp;        }
<i>533</i>&nbsp;    }
<i>534</i>&nbsp;
<b class="nc"><i>535</i>&nbsp;    /**</b>
<i>536</i>&nbsp;     * Returns a &lt;code&gt;PropertyChangeListener&lt;/code&gt; that will be installed
<i>537</i>&nbsp;     * on the horizontal &lt;code&gt;JScrollBar&lt;/code&gt;.
<i>538</i>&nbsp;     */
<i>539</i>&nbsp;    private PropertyChangeListener createHSBPropertyChangeListener() {
<i>540</i>&nbsp;        return getHandler();
<i>541</i>&nbsp;    }
<i>542</i>&nbsp;
<i>543</i>&nbsp;    /**
<i>544</i>&nbsp;     * Returns an instance of horizontal scroll bar {@code ChangeListener}.
<i>545</i>&nbsp;     *
<i>546</i>&nbsp;     * @return an instance of horizontal scroll bar {@code ChangeListener}
<i>547</i>&nbsp;     */
<i>548</i>&nbsp;    protected ChangeListener createHSBChangeListener() {
<i>549</i>&nbsp;        return getHandler();
<b class="nc"><i>550</i>&nbsp;    }</b>
<i>551</i>&nbsp;
<i>552</i>&nbsp;
<i>553</i>&nbsp;    /**
<i>554</i>&nbsp;     * Vertical scrollbar listener.
<i>555</i>&nbsp;     */
<i>556</i>&nbsp;    public class VSBChangeListener implements ChangeListener
<i>557</i>&nbsp;    {
<i>558</i>&nbsp;
<i>559</i>&nbsp;        // NOTE: This class exists only for backward compatibility. All
<i>560</i>&nbsp;        // its functionality has been moved into Handler. If you need to add
<i>561</i>&nbsp;        // new functionality add it to the Handler, but make sure this
<i>562</i>&nbsp;        // class calls into the Handler.
<i>563</i>&nbsp;
<i>564</i>&nbsp;        public void stateChanged(ChangeEvent e)
<b class="nc"><i>565</i>&nbsp;        {</b>
<i>566</i>&nbsp;            getHandler().stateChanged(e);
<i>567</i>&nbsp;        }
<i>568</i>&nbsp;    }
<b class="nc"><i>569</i>&nbsp;</b>
<b class="nc"><i>570</i>&nbsp;</b>
<i>571</i>&nbsp;    /**
<i>572</i>&nbsp;     * Returns a &lt;code&gt;PropertyChangeListener&lt;/code&gt; that will be installed
<i>573</i>&nbsp;     * on the vertical &lt;code&gt;JScrollBar&lt;/code&gt;.
<i>574</i>&nbsp;     */
<i>575</i>&nbsp;    private PropertyChangeListener createVSBPropertyChangeListener() {
<b class="nc"><i>576</i>&nbsp;        return getHandler();</b>
<b class="nc"><i>577</i>&nbsp;    }</b>
<i>578</i>&nbsp;
<b class="nc"><i>579</i>&nbsp;    /**</b>
<b class="nc"><i>580</i>&nbsp;     * Returns an instance of vertical scroll bar {@code ChangeListener}.</b>
<i>581</i>&nbsp;     *
<i>582</i>&nbsp;     * @return an instance of vertical scroll bar {@code ChangeListener}
<b class="nc"><i>583</i>&nbsp;     */</b>
<b class="nc"><i>584</i>&nbsp;    protected ChangeListener createVSBChangeListener() {</b>
<b class="nc"><i>585</i>&nbsp;        return getHandler();</b>
<b class="nc"><i>586</i>&nbsp;    }</b>
<i>587</i>&nbsp;
<b class="nc"><i>588</i>&nbsp;    /**</b>
<b class="nc"><i>589</i>&nbsp;     * MouseWheelHandler is an inner class which implements the</b>
<b class="nc"><i>590</i>&nbsp;     * MouseWheelListener interface.  MouseWheelHandler responds to</b>
<b class="nc"><i>591</i>&nbsp;     * MouseWheelEvents by scrolling the JScrollPane appropriately.</b>
<i>592</i>&nbsp;     * If the scroll pane&#39;s
<b class="nc"><i>593</i>&nbsp;     * &lt;code&gt;isWheelScrollingEnabled&lt;/code&gt;</b>
<i>594</i>&nbsp;     * method returns false, no scrolling occurs.
<i>595</i>&nbsp;     *
<b class="nc"><i>596</i>&nbsp;     * @see javax.swing.JScrollPane#isWheelScrollingEnabled</b>
<b class="nc"><i>597</i>&nbsp;     * @see #createMouseWheelListener</b>
<b class="nc"><i>598</i>&nbsp;     * @see java.awt.event.MouseWheelListener</b>
<i>599</i>&nbsp;     * @see java.awt.event.MouseWheelEvent
<i>600</i>&nbsp;     * @since 1.4
<i>601</i>&nbsp;     */
<i>602</i>&nbsp;    protected class MouseWheelHandler implements MouseWheelListener {
<i>603</i>&nbsp;
<i>604</i>&nbsp;        // NOTE: This class exists only for backward compatibility. All
<b class="nc"><i>605</i>&nbsp;        // its functionality has been moved into Handler. If you need to add</b>
<b class="nc"><i>606</i>&nbsp;        // new functionality add it to the Handler, but make sure this</b>
<b class="nc"><i>607</i>&nbsp;        // class calls into the Handler.</b>
<b class="nc"><i>608</i>&nbsp;</b>
<b class="nc"><i>609</i>&nbsp;        /**</b>
<b class="nc"><i>610</i>&nbsp;         * Called when the mouse wheel is rotated while over a</b>
<i>611</i>&nbsp;         * JScrollPane.
<i>612</i>&nbsp;         *
<i>613</i>&nbsp;         * @param e     MouseWheelEvent to be handled
<i>614</i>&nbsp;         * @since 1.4
<i>615</i>&nbsp;         */
<i>616</i>&nbsp;        public void mouseWheelMoved(MouseWheelEvent e) {
<b class="nc"><i>617</i>&nbsp;            getHandler().mouseWheelMoved(e);</b>
<b class="nc"><i>618</i>&nbsp;        }</b>
<b class="nc"><i>619</i>&nbsp;    }</b>
<b class="nc"><i>620</i>&nbsp;</b>
<b class="nc"><i>621</i>&nbsp;    /**</b>
<b class="nc"><i>622</i>&nbsp;     * Creates an instance of MouseWheelListener, which is added to the</b>
<i>623</i>&nbsp;     * JScrollPane by installUI().  The returned MouseWheelListener is used
<b class="nc"><i>624</i>&nbsp;     * to handle mouse wheel-driven scrolling.</b>
<b class="nc"><i>625</i>&nbsp;     *</b>
<i>626</i>&nbsp;     * @return      MouseWheelListener which implements wheel-driven scrolling
<b class="nc"><i>627</i>&nbsp;     * @see #installUI</b>
<i>628</i>&nbsp;     * @see MouseWheelHandler
<i>629</i>&nbsp;     * @since 1.4
<b class="nc"><i>630</i>&nbsp;     */</b>
<b class="nc"><i>631</i>&nbsp;    protected MouseWheelListener createMouseWheelListener() {</b>
<i>632</i>&nbsp;        return getHandler();
<i>633</i>&nbsp;    }
<i>634</i>&nbsp;
<i>635</i>&nbsp;    /**
<b class="nc"><i>636</i>&nbsp;     * Updates a scroll bar display policy.</b>
<i>637</i>&nbsp;     *
<i>638</i>&nbsp;     * @param e the property change event
<i>639</i>&nbsp;     */
<b class="nc"><i>640</i>&nbsp;    protected void updateScrollBarDisplayPolicy(PropertyChangeEvent e) {</b>
<i>641</i>&nbsp;        scrollpane.revalidate();
<i>642</i>&nbsp;        scrollpane.repaint();
<i>643</i>&nbsp;    }
<i>644</i>&nbsp;
<b class="nc"><i>645</i>&nbsp;    /**</b>
<b class="nc"><i>646</i>&nbsp;     * Updates viewport.</b>
<b class="nc"><i>647</i>&nbsp;     *</b>
<b class="nc"><i>648</i>&nbsp;     * @param e the property change event</b>
<i>649</i>&nbsp;     */
<b class="nc"><i>650</i>&nbsp;    protected void updateViewport(PropertyChangeEvent e)</b>
<b class="nc"><i>651</i>&nbsp;    {</b>
<i>652</i>&nbsp;        JViewport oldViewport = (JViewport)(e.getOldValue());
<i>653</i>&nbsp;        JViewport newViewport = (JViewport)(e.getNewValue());
<b class="nc"><i>654</i>&nbsp;</b>
<b class="nc"><i>655</i>&nbsp;        if (oldViewport != null) {</b>
<b class="nc"><i>656</i>&nbsp;            oldViewport.removeChangeListener(viewportChangeListener);</b>
<b class="nc"><i>657</i>&nbsp;        }</b>
<i>658</i>&nbsp;
<b class="nc"><i>659</i>&nbsp;        if (newViewport != null) {</b>
<b class="nc"><i>660</i>&nbsp;            Point p = newViewport.getViewPosition();</b>
<i>661</i>&nbsp;            if (scrollpane.getComponentOrientation().isLeftToRight()) {
<i>662</i>&nbsp;                p.x = Math.max(p.x, 0);
<i>663</i>&nbsp;            } else {
<i>664</i>&nbsp;                int max = newViewport.getViewSize().width;
<b class="nc"><i>665</i>&nbsp;                int extent = newViewport.getExtentSize().width;</b>
<i>666</i>&nbsp;                if (extent &gt; max) {
<i>667</i>&nbsp;                    p.x = max - extent;
<i>668</i>&nbsp;                } else {
<i>669</i>&nbsp;                    p.x = Math.max(0, Math.min(max - extent, p.x));
<i>670</i>&nbsp;                }
<i>671</i>&nbsp;            }
<i>672</i>&nbsp;            p.y = Math.max(p.y, 0);
<i>673</i>&nbsp;            newViewport.setViewPosition(p);
<i>674</i>&nbsp;            newViewport.addChangeListener(viewportChangeListener);
<b class="nc"><i>675</i>&nbsp;        }</b>
<i>676</i>&nbsp;    }
<i>677</i>&nbsp;
<i>678</i>&nbsp;    /**
<i>679</i>&nbsp;     * Updates row header.
<i>680</i>&nbsp;     *
<i>681</i>&nbsp;     * @param e the property change event
<i>682</i>&nbsp;     */
<i>683</i>&nbsp;    protected void updateRowHeader(PropertyChangeEvent e)
<i>684</i>&nbsp;    {
<i>685</i>&nbsp;        JViewport newRowHead = (JViewport)(e.getNewValue());
<i>686</i>&nbsp;        if (newRowHead != null) {
<i>687</i>&nbsp;            JViewport viewport = scrollpane.getViewport();
<i>688</i>&nbsp;            Point p = newRowHead.getViewPosition();
<i>689</i>&nbsp;            p.y = (viewport != null) ? viewport.getViewPosition().y : 0;
<i>690</i>&nbsp;            newRowHead.setViewPosition(p);
<i>691</i>&nbsp;        }
<i>692</i>&nbsp;    }
<i>693</i>&nbsp;
<i>694</i>&nbsp;    /**
<i>695</i>&nbsp;     * Updates column header.
<i>696</i>&nbsp;     *
<i>697</i>&nbsp;     * @param e the property change event
<i>698</i>&nbsp;     */
<i>699</i>&nbsp;    protected void updateColumnHeader(PropertyChangeEvent e)
<i>700</i>&nbsp;    {
<i>701</i>&nbsp;        JViewport newColHead = (JViewport)(e.getNewValue());
<i>702</i>&nbsp;        if (newColHead != null) {
<i>703</i>&nbsp;            JViewport viewport = scrollpane.getViewport();
<i>704</i>&nbsp;            Point p = newColHead.getViewPosition();
<b class="nc"><i>705</i>&nbsp;            if (viewport == null) {</b>
<i>706</i>&nbsp;                p.x = 0;
<i>707</i>&nbsp;            } else {
<i>708</i>&nbsp;                if (scrollpane.getComponentOrientation().isLeftToRight()) {
<i>709</i>&nbsp;                    p.x = viewport.getViewPosition().x;
<i>710</i>&nbsp;                } else {
<i>711</i>&nbsp;                    p.x = Math.max(0, viewport.getViewPosition().x);
<i>712</i>&nbsp;                }
<i>713</i>&nbsp;            }
<i>714</i>&nbsp;            newColHead.setViewPosition(p);
<i>715</i>&nbsp;            scrollpane.add(newColHead, COLUMN_HEADER);
<i>716</i>&nbsp;        }
<i>717</i>&nbsp;    }
<i>718</i>&nbsp;
<i>719</i>&nbsp;    private void updateHorizontalScrollBar(PropertyChangeEvent pce) {
<i>720</i>&nbsp;        updateScrollBar(pce, hsbChangeListener, hsbPropertyChangeListener);
<i>721</i>&nbsp;    }
<i>722</i>&nbsp;
<b class="nc"><i>723</i>&nbsp;    private void updateVerticalScrollBar(PropertyChangeEvent pce) {</b>
<i>724</i>&nbsp;        updateScrollBar(pce, vsbChangeListener, vsbPropertyChangeListener);
<i>725</i>&nbsp;    }
<i>726</i>&nbsp;
<b class="nc"><i>727</i>&nbsp;    private void updateScrollBar(PropertyChangeEvent pce, ChangeListener cl,</b>
<b class="nc"><i>728</i>&nbsp;                                 PropertyChangeListener pcl) {</b>
<b class="nc"><i>729</i>&nbsp;        JScrollBar sb = (JScrollBar)pce.getOldValue();</b>
<i>730</i>&nbsp;        if (sb != null) {
<b class="nc"><i>731</i>&nbsp;            if (cl != null) {</b>
<b class="nc"><i>732</i>&nbsp;                sb.getModel().removeChangeListener(cl);</b>
<i>733</i>&nbsp;            }
<b class="nc"><i>734</i>&nbsp;            if (pcl != null) {</b>
<b class="nc"><i>735</i>&nbsp;                sb.removePropertyChangeListener(pcl);</b>
<i>736</i>&nbsp;            }
<b class="nc"><i>737</i>&nbsp;        }</b>
<b class="nc"><i>738</i>&nbsp;        sb = (JScrollBar)pce.getNewValue();</b>
<i>739</i>&nbsp;        if (sb != null) {
<b class="nc"><i>740</i>&nbsp;            if (cl != null) {</b>
<b class="nc"><i>741</i>&nbsp;                sb.getModel().addChangeListener(cl);</b>
<i>742</i>&nbsp;            }
<b class="nc"><i>743</i>&nbsp;            if (pcl != null) {</b>
<b class="nc"><i>744</i>&nbsp;                sb.addPropertyChangeListener(pcl);</b>
<i>745</i>&nbsp;            }
<b class="nc"><i>746</i>&nbsp;        }</b>
<b class="nc"><i>747</i>&nbsp;    }</b>
<i>748</i>&nbsp;
<b class="nc"><i>749</i>&nbsp;    /**</b>
<b class="nc"><i>750</i>&nbsp;     * Property change handler.</b>
<i>751</i>&nbsp;     */
<i>752</i>&nbsp;    public class PropertyChangeHandler implements PropertyChangeListener
<b class="nc"><i>753</i>&nbsp;    {</b>
<b class="nc"><i>754</i>&nbsp;</b>
<i>755</i>&nbsp;        // NOTE: This class exists only for backward compatibility. All
<i>756</i>&nbsp;        // its functionality has been moved into Handler. If you need to add
<b class="nc"><i>757</i>&nbsp;        // new functionality add it to the Handler, but make sure this</b>
<b class="nc"><i>758</i>&nbsp;        // class calls into the Handler.</b>
<i>759</i>&nbsp;
<i>760</i>&nbsp;        /**
<b class="nc"><i>761</i>&nbsp;         * {@inheritDoc}</b>
<b class="nc"><i>762</i>&nbsp;         */</b>
<i>763</i>&nbsp;        public void propertyChange(PropertyChangeEvent e)
<i>764</i>&nbsp;        {
<i>765</i>&nbsp;            getHandler().propertyChange(e);
<i>766</i>&nbsp;        }
<i>767</i>&nbsp;    }
<b class="nc"><i>768</i>&nbsp;</b>
<i>769</i>&nbsp;
<b class="nc"><i>770</i>&nbsp;</b>
<b class="nc"><i>771</i>&nbsp;    /**</b>
<b class="nc"><i>772</i>&nbsp;     * Creates an instance of {@code PropertyChangeListener} that&#39;s added to</b>
<b class="nc"><i>773</i>&nbsp;     * the {@code JScrollPane} by {@code installUI()}. Subclasses can override</b>
<b class="nc"><i>774</i>&nbsp;     * this method to return a custom {@code PropertyChangeListener}, e.g.</b>
<i>775</i>&nbsp;     * &lt;pre&gt;
<i>776</i>&nbsp;     * class MyScrollPaneUI extends BasicScrollPaneUI {
<b class="nc"><i>777</i>&nbsp;     *    protected PropertyChangeListener &lt;b&gt;createPropertyChangeListener&lt;/b&gt;() {</b>
<i>778</i>&nbsp;     *        return new MyPropertyChangeListener();
<i>779</i>&nbsp;     *    }
<i>780</i>&nbsp;     *    public class MyPropertyChangeListener extends PropertyChangeListener {
<i>781</i>&nbsp;     *        public void propertyChange(PropertyChangeEvent e) {
<i>782</i>&nbsp;     *            if (e.getPropertyName().equals(&quot;viewport&quot;)) {
<i>783</i>&nbsp;     *                // do some extra work when the viewport changes
<b class="nc"><i>784</i>&nbsp;     *            }</b>
<i>785</i>&nbsp;     *            super.propertyChange(e);
<b class="nc"><i>786</i>&nbsp;     *        }</b>
<b class="nc"><i>787</i>&nbsp;     *    }</b>
<b class="nc"><i>788</i>&nbsp;     * }</b>
<i>789</i>&nbsp;     * &lt;/pre&gt;
<b class="nc"><i>790</i>&nbsp;     *</b>
<b class="nc"><i>791</i>&nbsp;     * @return an instance of {@code PropertyChangeListener}</b>
<b class="nc"><i>792</i>&nbsp;     *</b>
<i>793</i>&nbsp;     * @see java.beans.PropertyChangeListener
<i>794</i>&nbsp;     * @see #installUI
<i>795</i>&nbsp;     */
<i>796</i>&nbsp;    protected PropertyChangeListener createPropertyChangeListener() {
<i>797</i>&nbsp;        return getHandler();
<i>798</i>&nbsp;    }
<b class="nc"><i>799</i>&nbsp;</b>
<i>800</i>&nbsp;
<b class="nc"><i>801</i>&nbsp;    private static class Actions extends UIAction {</b>
<b class="nc"><i>802</i>&nbsp;        private static final String SCROLL_UP = &quot;scrollUp&quot;;</b>
<b class="nc"><i>803</i>&nbsp;        private static final String SCROLL_DOWN = &quot;scrollDown&quot;;</b>
<i>804</i>&nbsp;        private static final String SCROLL_HOME = &quot;scrollHome&quot;;
<i>805</i>&nbsp;        private static final String SCROLL_END = &quot;scrollEnd&quot;;
<b class="nc"><i>806</i>&nbsp;        private static final String UNIT_SCROLL_UP = &quot;unitScrollUp&quot;;</b>
<b class="nc"><i>807</i>&nbsp;        private static final String UNIT_SCROLL_DOWN = &quot;unitScrollDown&quot;;</b>
<b class="nc"><i>808</i>&nbsp;        private static final String SCROLL_LEFT = &quot;scrollLeft&quot;;</b>
<b class="nc"><i>809</i>&nbsp;        private static final String SCROLL_RIGHT = &quot;scrollRight&quot;;</b>
<i>810</i>&nbsp;        private static final String UNIT_SCROLL_LEFT = &quot;unitScrollLeft&quot;;
<i>811</i>&nbsp;        private static final String UNIT_SCROLL_RIGHT = &quot;unitScrollRight&quot;;
<b class="nc"><i>812</i>&nbsp;</b>
<b class="nc"><i>813</i>&nbsp;</b>
<i>814</i>&nbsp;        Actions(String key) {
<i>815</i>&nbsp;            super(key);
<i>816</i>&nbsp;        }
<b class="nc"><i>817</i>&nbsp;</b>
<b class="nc"><i>818</i>&nbsp;        public void actionPerformed(ActionEvent e) {</b>
<b class="nc"><i>819</i>&nbsp;            JScrollPane scrollPane = (JScrollPane)e.getSource();</b>
<i>820</i>&nbsp;            boolean ltr = scrollPane.getComponentOrientation().isLeftToRight();
<i>821</i>&nbsp;            String key = getName();
<b class="nc"><i>822</i>&nbsp;</b>
<i>823</i>&nbsp;            if (key == SCROLL_UP) {
<i>824</i>&nbsp;                scroll(scrollPane, SwingConstants.VERTICAL, -1, true);
<i>825</i>&nbsp;            }
<b class="nc"><i>826</i>&nbsp;            else if (key == SCROLL_DOWN) {</b>
<i>827</i>&nbsp;                scroll(scrollPane, SwingConstants.VERTICAL, 1, true);
<i>828</i>&nbsp;            }
<b class="nc"><i>829</i>&nbsp;            else if (key == SCROLL_HOME) {</b>
<b class="nc"><i>830</i>&nbsp;                scrollHome(scrollPane);</b>
<b class="nc"><i>831</i>&nbsp;            }</b>
<b class="nc"><i>832</i>&nbsp;            else if (key == SCROLL_END) {</b>
<i>833</i>&nbsp;                scrollEnd(scrollPane);
<b class="nc"><i>834</i>&nbsp;            }</b>
<b class="nc"><i>835</i>&nbsp;            else if (key == UNIT_SCROLL_UP) {</b>
<i>836</i>&nbsp;                scroll(scrollPane, SwingConstants.VERTICAL, -1, false);
<i>837</i>&nbsp;            }
<i>838</i>&nbsp;            else if (key == UNIT_SCROLL_DOWN) {
<b class="nc"><i>839</i>&nbsp;                scroll(scrollPane, SwingConstants.VERTICAL, 1, false);</b>
<b class="nc"><i>840</i>&nbsp;            }</b>
<b class="nc"><i>841</i>&nbsp;            else if (key == SCROLL_LEFT) {</b>
<b class="nc"><i>842</i>&nbsp;                scroll(scrollPane, SwingConstants.HORIZONTAL, ltr ? -1 : 1,</b>
<b class="nc"><i>843</i>&nbsp;                       true);</b>
<b class="nc"><i>844</i>&nbsp;            }</b>
<i>845</i>&nbsp;            else if (key == SCROLL_RIGHT) {
<i>846</i>&nbsp;                scroll(scrollPane, SwingConstants.HORIZONTAL, ltr ? 1 : -1,
<b class="nc"><i>847</i>&nbsp;                       true);</b>
<b class="nc"><i>848</i>&nbsp;            }</b>
<b class="nc"><i>849</i>&nbsp;            else if (key == UNIT_SCROLL_LEFT) {</b>
<i>850</i>&nbsp;                scroll(scrollPane, SwingConstants.HORIZONTAL, ltr ? -1 : 1,
<b class="nc"><i>851</i>&nbsp;                       false);</b>
<i>852</i>&nbsp;            }
<i>853</i>&nbsp;            else if (key == UNIT_SCROLL_RIGHT) {
<i>854</i>&nbsp;                scroll(scrollPane, SwingConstants.HORIZONTAL, ltr ? 1 : -1,
<b class="nc"><i>855</i>&nbsp;                       false);</b>
<i>856</i>&nbsp;            }
<i>857</i>&nbsp;        }
<i>858</i>&nbsp;
<i>859</i>&nbsp;        private void scrollEnd(JScrollPane scrollpane) {
<i>860</i>&nbsp;            JViewport vp = scrollpane.getViewport();
<b class="nc"><i>861</i>&nbsp;            Component view;</b>
<i>862</i>&nbsp;            if (vp != null &amp;&amp; (view = vp.getView()) != null) {
<i>863</i>&nbsp;                Rectangle visRect = vp.getViewRect();
<i>864</i>&nbsp;                Rectangle bounds = view.getBounds();
<i>865</i>&nbsp;                if (scrollpane.getComponentOrientation().isLeftToRight()) {
<b class="nc"><i>866</i>&nbsp;                    vp.setViewPosition(new Point(bounds.width - visRect.width,</b>
<b class="nc"><i>867</i>&nbsp;                                             bounds.height - visRect.height));</b>
<b class="nc"><i>868</i>&nbsp;                } else {</b>
<b class="nc"><i>869</i>&nbsp;                    vp.setViewPosition(new Point(0,</b>
<b class="nc"><i>870</i>&nbsp;                                             bounds.height - visRect.height));</b>
<i>871</i>&nbsp;                }
<i>872</i>&nbsp;            }
<b class="nc"><i>873</i>&nbsp;        }</b>
<b class="nc"><i>874</i>&nbsp;</b>
<b class="nc"><i>875</i>&nbsp;        private void scrollHome(JScrollPane scrollpane) {</b>
<b class="nc"><i>876</i>&nbsp;            JViewport vp = scrollpane.getViewport();</b>
<i>877</i>&nbsp;            Component view;
<i>878</i>&nbsp;            if (vp != null &amp;&amp; (view = vp.getView()) != null) {
<b class="nc"><i>879</i>&nbsp;                if (scrollpane.getComponentOrientation().isLeftToRight()) {</b>
<i>880</i>&nbsp;                    vp.setViewPosition(new Point(0, 0));
<i>881</i>&nbsp;                } else {
<b class="nc"><i>882</i>&nbsp;                    Rectangle visRect = vp.getViewRect();</b>
<i>883</i>&nbsp;                    Rectangle bounds = view.getBounds();
<b class="nc"><i>884</i>&nbsp;                    vp.setViewPosition(new Point(bounds.width - visRect.width, 0));</b>
<b class="nc"><i>885</i>&nbsp;                }</b>
<b class="nc"><i>886</i>&nbsp;            }</b>
<b class="nc"><i>887</i>&nbsp;        }</b>
<b class="nc"><i>888</i>&nbsp;</b>
<i>889</i>&nbsp;        private void scroll(JScrollPane scrollpane, int orientation,
<i>890</i>&nbsp;                            int direction, boolean block) {
<i>891</i>&nbsp;            JViewport vp = scrollpane.getViewport();
<i>892</i>&nbsp;            Component view;
<i>893</i>&nbsp;            if (vp != null &amp;&amp; (view = vp.getView()) != null) {
<i>894</i>&nbsp;                Rectangle visRect = vp.getViewRect();
<i>895</i>&nbsp;                Dimension vSize = view.getSize();
<i>896</i>&nbsp;                int amount;
<b class="nc"><i>897</i>&nbsp;</b>
<i>898</i>&nbsp;                if (view instanceof Scrollable) {
<i>899</i>&nbsp;                    if (block) {
<b class="nc"><i>900</i>&nbsp;                        amount = ((Scrollable)view).getScrollableBlockIncrement</b>
<i>901</i>&nbsp;                                 (visRect, orientation, direction);
<b class="nc"><i>902</i>&nbsp;                    }</b>
<i>903</i>&nbsp;                    else {
<i>904</i>&nbsp;                        amount = ((Scrollable)view).getScrollableUnitIncrement
<i>905</i>&nbsp;                                 (visRect, orientation, direction);
<i>906</i>&nbsp;                    }
<i>907</i>&nbsp;                }
<i>908</i>&nbsp;                else {
<i>909</i>&nbsp;                    if (block) {
<i>910</i>&nbsp;                        if (orientation == SwingConstants.VERTICAL) {
<i>911</i>&nbsp;                            amount = visRect.height;
<i>912</i>&nbsp;                        }
<i>913</i>&nbsp;                        else {
<b class="nc"><i>914</i>&nbsp;                            amount = visRect.width;</b>
<b class="nc"><i>915</i>&nbsp;                        }</b>
<b class="nc"><i>916</i>&nbsp;                    }</b>
<b class="nc"><i>917</i>&nbsp;                    else {</b>
<b class="nc"><i>918</i>&nbsp;                        amount = 10;</b>
<b class="nc"><i>919</i>&nbsp;                    }</b>
<b class="nc"><i>920</i>&nbsp;                }</b>
<b class="nc"><i>921</i>&nbsp;                if (orientation == SwingConstants.VERTICAL) {</b>
<i>922</i>&nbsp;                    visRect.y += (amount * direction);
<b class="nc"><i>923</i>&nbsp;                    if ((visRect.y + visRect.height) &gt; vSize.height) {</b>
<b class="nc"><i>924</i>&nbsp;                        visRect.y = Math.max(0, vSize.height - visRect.height);</b>
<b class="nc"><i>925</i>&nbsp;                    }</b>
<i>926</i>&nbsp;                    else if (visRect.y &lt; 0) {
<i>927</i>&nbsp;                        visRect.y = 0;
<b class="nc"><i>928</i>&nbsp;                    }</b>
<b class="nc"><i>929</i>&nbsp;                }</b>
<b class="nc"><i>930</i>&nbsp;                else {</b>
<i>931</i>&nbsp;                    if (scrollpane.getComponentOrientation().isLeftToRight()) {
<i>932</i>&nbsp;                        visRect.x += (amount * direction);
<b class="nc"><i>933</i>&nbsp;                        if ((visRect.x + visRect.width) &gt; vSize.width) {</b>
<b class="nc"><i>934</i>&nbsp;                            visRect.x = Math.max(0, vSize.width - visRect.width);</b>
<i>935</i>&nbsp;                        } else if (visRect.x &lt; 0) {
<i>936</i>&nbsp;                            visRect.x = 0;
<i>937</i>&nbsp;                        }
<b class="nc"><i>938</i>&nbsp;                    } else {</b>
<b class="nc"><i>939</i>&nbsp;                        visRect.x -= (amount * direction);</b>
<b class="nc"><i>940</i>&nbsp;                        if (visRect.width &gt; vSize.width) {</b>
<i>941</i>&nbsp;                            visRect.x = vSize.width - visRect.width;
<i>942</i>&nbsp;                        } else {
<i>943</i>&nbsp;                            visRect.x = Math.max(0, Math.min(vSize.width - visRect.width, visRect.x));
<b class="nc"><i>944</i>&nbsp;                        }</b>
<b class="nc"><i>945</i>&nbsp;                    }</b>
<b class="nc"><i>946</i>&nbsp;                }</b>
<b class="nc"><i>947</i>&nbsp;                vp.setViewPosition(visRect.getLocation());</b>
<b class="nc"><i>948</i>&nbsp;            }</b>
<b class="nc"><i>949</i>&nbsp;        }</b>
<i>950</i>&nbsp;    }
<i>951</i>&nbsp;
<i>952</i>&nbsp;
<b class="nc"><i>953</i>&nbsp;    class Handler implements ChangeListener, PropertyChangeListener, MouseWheelListener {</b>
<b class="nc"><i>954</i>&nbsp;        //</b>
<b class="nc"><i>955</i>&nbsp;        // MouseWheelListener</b>
<b class="nc"><i>956</i>&nbsp;        //</b>
<i>957</i>&nbsp;        public void mouseWheelMoved(MouseWheelEvent e) {
<i>958</i>&nbsp;            if (scrollpane.isWheelScrollingEnabled() &amp;&amp;
<i>959</i>&nbsp;                e.getWheelRotation() != 0) {
<i>960</i>&nbsp;                JScrollBar toScroll = scrollpane.getVerticalScrollBar();
<i>961</i>&nbsp;                int direction = e.getWheelRotation() &lt; 0 ? -1 : 1;
<b class="nc"><i>962</i>&nbsp;                int orientation = SwingConstants.VERTICAL;</b>
<i>963</i>&nbsp;
<b class="nc"><i>964</i>&nbsp;                // find which scrollbar to scroll, or return if none</b>
<b class="nc"><i>965</i>&nbsp;                if (toScroll == null || !toScroll.isVisible()</b>
<b class="nc"><i>966</i>&nbsp;                        || e.isShiftDown()) {</b>
<b class="nc"><i>967</i>&nbsp;                    toScroll = scrollpane.getHorizontalScrollBar();</b>
<b class="nc"><i>968</i>&nbsp;                    if (toScroll == null || !toScroll.isVisible()) {</b>
<i>969</i>&nbsp;                        return;
<i>970</i>&nbsp;                    }
<i>971</i>&nbsp;                    orientation = SwingConstants.HORIZONTAL;
<i>972</i>&nbsp;                }
<b class="nc"><i>973</i>&nbsp;</b>
<i>974</i>&nbsp;                e.consume();
<b class="nc"><i>975</i>&nbsp;</b>
<b class="nc"><i>976</i>&nbsp;                if (e.getScrollType() == MouseWheelEvent.WHEEL_UNIT_SCROLL) {</b>
<b class="nc"><i>977</i>&nbsp;                    JViewport vp = scrollpane.getViewport();</b>
<b class="nc"><i>978</i>&nbsp;                    if (vp == null) { return; }</b>
<b class="nc"><i>979</i>&nbsp;                    Component comp = vp.getView();</b>
<i>980</i>&nbsp;                    int units = Math.abs(e.getUnitsToScroll());
<i>981</i>&nbsp;
<i>982</i>&nbsp;                    // When the scrolling speed is set to maximum, it&#39;s possible
<i>983</i>&nbsp;                    // for a single wheel click to scroll by more units than
<b class="nc"><i>984</i>&nbsp;                    // will fit in the visible area.  This makes it</b>
<i>985</i>&nbsp;                    // hard/impossible to get to certain parts of the scrolling
<i>986</i>&nbsp;                    // Component with the wheel.  To make for more accurate
<i>987</i>&nbsp;                    // low-speed scrolling, we limit scrolling to the block
<i>988</i>&nbsp;                    // increment if the wheel was only rotated one click.
<b class="nc"><i>989</i>&nbsp;                    boolean limitScroll = Math.abs(e.getWheelRotation()) == 1;</b>
<b class="nc"><i>990</i>&nbsp;</b>
<i>991</i>&nbsp;                    // Check if we should use the visibleRect trick
<i>992</i>&nbsp;                    Object fastWheelScroll = toScroll.getClientProperty(
<b class="nc"><i>993</i>&nbsp;                                               &quot;JScrollBar.fastWheelScrolling&quot;);</b>
<b class="nc"><i>994</i>&nbsp;                    if (Boolean.TRUE == fastWheelScroll &amp;&amp;</b>
<i>995</i>&nbsp;                        comp instanceof Scrollable) {
<i>996</i>&nbsp;                        // 5078454: Under maximum acceleration, we may scroll
<i>997</i>&nbsp;                        // by many 100s of units in ~1 second.
<i>998</i>&nbsp;                        //
<i>999</i>&nbsp;                        // BasicScrollBarUI.scrollByUnits() can bog down the EDT
<b class="nc"><i>1000</i>&nbsp;                        // with repaints in this situation.  However, the</b>
<i>1001</i>&nbsp;                        // Scrollable interface allows us to pass in an
<b class="nc"><i>1002</i>&nbsp;                        // arbitrary visibleRect.  This allows us to accurately</b>
<b class="nc"><i>1003</i>&nbsp;                        // calculate the total scroll amount, and then update</b>
<i>1004</i>&nbsp;                        // the GUI once.  This technique provides much faster
<b class="nc"><i>1005</i>&nbsp;                        // accelerated wheel scrolling.</b>
<b class="nc"><i>1006</i>&nbsp;                        Scrollable scrollComp = (Scrollable) comp;</b>
<i>1007</i>&nbsp;                        Rectangle viewRect = vp.getViewRect();
<b class="nc"><i>1008</i>&nbsp;                        int startingX = viewRect.x;</b>
<i>1009</i>&nbsp;                        boolean leftToRight =
<i>1010</i>&nbsp;                                 comp.getComponentOrientation().isLeftToRight();
<b class="nc"><i>1011</i>&nbsp;                        int scrollMin = toScroll.getMinimum();</b>
<i>1012</i>&nbsp;                        int scrollMax = toScroll.getMaximum() -
<i>1013</i>&nbsp;                                        toScroll.getModel().getExtent();
<i>1014</i>&nbsp;
<b class="nc"><i>1015</i>&nbsp;                        if (limitScroll) {</b>
<i>1016</i>&nbsp;                            int blockIncr =
<i>1017</i>&nbsp;                                scrollComp.getScrollableBlockIncrement(viewRect,
<b class="nc"><i>1018</i>&nbsp;                                                                    orientation,</b>
<b class="nc"><i>1019</i>&nbsp;                                                                    direction);</b>
<i>1020</i>&nbsp;                            if (direction &lt; 0) {
<b class="nc"><i>1021</i>&nbsp;                                scrollMin = Math.max(scrollMin,</b>
<i>1022</i>&nbsp;                                               toScroll.getValue() - blockIncr);
<i>1023</i>&nbsp;                            }
<i>1024</i>&nbsp;                            else {
<i>1025</i>&nbsp;                                scrollMax = Math.min(scrollMax,
<i>1026</i>&nbsp;                                               toScroll.getValue() + blockIncr);
<i>1027</i>&nbsp;                            }
<i>1028</i>&nbsp;                        }
<i>1029</i>&nbsp;
<b class="nc"><i>1030</i>&nbsp;                        for (int i = 0; i &lt; units; i++) {</b>
<i>1031</i>&nbsp;                            int unitIncr =
<b class="nc"><i>1032</i>&nbsp;                                scrollComp.getScrollableUnitIncrement(viewRect,</b>
<b class="nc"><i>1033</i>&nbsp;                                                        orientation, direction);</b>
<b class="nc"><i>1034</i>&nbsp;                            // Modify the visible rect for the next unit, and</b>
<i>1035</i>&nbsp;                            // check to see if we&#39;re at the end already.
<i>1036</i>&nbsp;                            if (orientation == SwingConstants.VERTICAL) {
<b class="nc"><i>1037</i>&nbsp;                                if (direction &lt; 0) {</b>
<b class="nc"><i>1038</i>&nbsp;                                    viewRect.y -= unitIncr;</b>
<b class="nc"><i>1039</i>&nbsp;                                    if (viewRect.y &lt;= scrollMin) {</b>
<i>1040</i>&nbsp;                                        viewRect.y = scrollMin;
<i>1041</i>&nbsp;                                        break;
<b class="nc"><i>1042</i>&nbsp;                                    }</b>
<b class="nc"><i>1043</i>&nbsp;                                }</b>
<b class="nc"><i>1044</i>&nbsp;                                else { // (direction &gt; 0</b>
<i>1045</i>&nbsp;                                    viewRect.y += unitIncr;
<i>1046</i>&nbsp;                                    if (viewRect.y &gt;= scrollMax) {
<i>1047</i>&nbsp;                                        viewRect.y = scrollMax;
<i>1048</i>&nbsp;                                        break;
<i>1049</i>&nbsp;                                    }
<i>1050</i>&nbsp;                                }
<i>1051</i>&nbsp;                            }
<b class="nc"><i>1052</i>&nbsp;                            else {</b>
<b class="nc"><i>1053</i>&nbsp;                                // Scroll left</b>
<b class="nc"><i>1054</i>&nbsp;                                if ((leftToRight &amp;&amp; direction &lt; 0) ||</b>
<b class="nc"><i>1055</i>&nbsp;                                    (!leftToRight &amp;&amp; direction &gt; 0)) {</b>
<i>1056</i>&nbsp;                                    viewRect.x -= unitIncr;
<i>1057</i>&nbsp;                                    if (leftToRight) {
<i>1058</i>&nbsp;                                        if (viewRect.x &lt; scrollMin) {
<b class="nc"><i>1059</i>&nbsp;                                            viewRect.x = scrollMin;</b>
<b class="nc"><i>1060</i>&nbsp;                                            break;</b>
<b class="nc"><i>1061</i>&nbsp;                                        }</b>
<b class="nc"><i>1062</i>&nbsp;                                    }</b>
<b class="nc"><i>1063</i>&nbsp;                                }</b>
<i>1064</i>&nbsp;                                // Scroll right
<b class="nc"><i>1065</i>&nbsp;                                else if ((leftToRight &amp;&amp; direction &gt; 0) ||</b>
<b class="nc"><i>1066</i>&nbsp;                                    (!leftToRight &amp;&amp; direction &lt; 0)) {</b>
<b class="nc"><i>1067</i>&nbsp;                                    viewRect.x += unitIncr;</b>
<i>1068</i>&nbsp;                                    if (leftToRight) {
<i>1069</i>&nbsp;                                        if (viewRect.x &gt; scrollMax) {
<i>1070</i>&nbsp;                                            viewRect.x = scrollMax;
<b class="nc"><i>1071</i>&nbsp;                                            break;</b>
<i>1072</i>&nbsp;                                        }
<i>1073</i>&nbsp;                                    }
<i>1074</i>&nbsp;                                }
<i>1075</i>&nbsp;                                else {
<b class="nc"><i>1076</i>&nbsp;                                    assert false : &quot;Non-sensical ComponentOrientation / scroll direction&quot;;</b>
<b class="nc"><i>1077</i>&nbsp;                                }</b>
<i>1078</i>&nbsp;                            }
<i>1079</i>&nbsp;                        }
<i>1080</i>&nbsp;                        // Set the final view position on the ScrollBar
<i>1081</i>&nbsp;                        if (orientation == SwingConstants.VERTICAL) {
<i>1082</i>&nbsp;                            toScroll.setValue(viewRect.y);
<b class="nc"><i>1083</i>&nbsp;                        }</b>
<b class="nc"><i>1084</i>&nbsp;                        else {</b>
<i>1085</i>&nbsp;                            if (leftToRight) {
<i>1086</i>&nbsp;                                toScroll.setValue(viewRect.x);
<i>1087</i>&nbsp;                            }
<b class="nc"><i>1088</i>&nbsp;                            else {</b>
<i>1089</i>&nbsp;                                // rightToLeft scrollbars are oriented with
<i>1090</i>&nbsp;                                // minValue on the right and maxValue on the
<i>1091</i>&nbsp;                                // left.
<i>1092</i>&nbsp;                                int newPos = toScroll.getValue() -
<i>1093</i>&nbsp;                                                       (viewRect.x - startingX);
<i>1094</i>&nbsp;                                if (newPos &lt; scrollMin) {
<i>1095</i>&nbsp;                                    newPos = scrollMin;
<i>1096</i>&nbsp;                                }
<i>1097</i>&nbsp;                                else if (newPos &gt; scrollMax) {
<i>1098</i>&nbsp;                                    newPos = scrollMax;
<b class="nc"><i>1099</i>&nbsp;                                }</b>
<b class="nc"><i>1100</i>&nbsp;                                toScroll.setValue(newPos);</b>
<i>1101</i>&nbsp;                            }
<i>1102</i>&nbsp;                        }
<b class="nc"><i>1103</i>&nbsp;                    }</b>
<i>1104</i>&nbsp;                    else {
<i>1105</i>&nbsp;                        // Viewport&#39;s view is not a Scrollable, or fast wheel
<i>1106</i>&nbsp;                        // scrolling is not enabled.
<i>1107</i>&nbsp;                        BasicScrollBarUI.scrollByUnits(toScroll, direction,
<b class="nc"><i>1108</i>&nbsp;                                                       units, limitScroll);</b>
<i>1109</i>&nbsp;                    }
<b class="nc"><i>1110</i>&nbsp;                }</b>
<b class="nc"><i>1111</i>&nbsp;                else if (e.getScrollType() ==</b>
<i>1112</i>&nbsp;                         MouseWheelEvent.WHEEL_BLOCK_SCROLL) {
<b class="nc"><i>1113</i>&nbsp;                    BasicScrollBarUI.scrollByBlock(toScroll, direction);</b>
<b class="nc"><i>1114</i>&nbsp;                }</b>
<i>1115</i>&nbsp;            }
<b class="nc"><i>1116</i>&nbsp;        }</b>
<b class="nc"><i>1117</i>&nbsp;</b>
<i>1118</i>&nbsp;        //
<b class="nc"><i>1119</i>&nbsp;        // ChangeListener: This is added to the vieport, and hsb/vsb models.</b>
<b class="nc"><i>1120</i>&nbsp;        //</b>
<i>1121</i>&nbsp;        public void stateChanged(ChangeEvent e) {
<b class="nc"><i>1122</i>&nbsp;            JViewport viewport = scrollpane.getViewport();</b>
<b class="nc"><i>1123</i>&nbsp;</b>
<i>1124</i>&nbsp;            if (viewport != null) {
<b class="nc"><i>1125</i>&nbsp;                if (e.getSource() == viewport) {</b>
<b class="nc"><i>1126</i>&nbsp;                    syncScrollPaneWithViewport();</b>
<i>1127</i>&nbsp;                }
<b class="nc"><i>1128</i>&nbsp;                else {</b>
<b class="nc"><i>1129</i>&nbsp;                    JScrollBar hsb = scrollpane.getHorizontalScrollBar();</b>
<i>1130</i>&nbsp;                    if (hsb != null &amp;&amp; e.getSource() == hsb.getModel()) {
<b class="nc"><i>1131</i>&nbsp;                        hsbStateChanged(viewport, e);</b>
<b class="nc"><i>1132</i>&nbsp;                    }</b>
<b class="nc"><i>1133</i>&nbsp;                    else {</b>
<i>1134</i>&nbsp;                        JScrollBar vsb = scrollpane.getVerticalScrollBar();
<i>1135</i>&nbsp;                        if (vsb != null &amp;&amp; e.getSource() == vsb.getModel()) {
<i>1136</i>&nbsp;                            vsbStateChanged(viewport, e);
<i>1137</i>&nbsp;                        }
<i>1138</i>&nbsp;                    }
<b class="nc"><i>1139</i>&nbsp;                }</b>
<b class="nc"><i>1140</i>&nbsp;            }</b>
<i>1141</i>&nbsp;        }
<b class="nc"><i>1142</i>&nbsp;</b>
<b class="nc"><i>1143</i>&nbsp;        private void vsbStateChanged(JViewport viewport, ChangeEvent e) {</b>
<b class="nc"><i>1144</i>&nbsp;            BoundedRangeModel model = (BoundedRangeModel)(e.getSource());</b>
<b class="nc"><i>1145</i>&nbsp;            Point p = viewport.getViewPosition();</b>
<b class="nc"><i>1146</i>&nbsp;            p.y = model.getValue();</b>
<i>1147</i>&nbsp;            viewport.setViewPosition(p);
<b class="nc"><i>1148</i>&nbsp;        }</b>
<b class="nc"><i>1149</i>&nbsp;</b>
<i>1150</i>&nbsp;        private void hsbStateChanged(JViewport viewport, ChangeEvent e) {
<b class="nc"><i>1151</i>&nbsp;            BoundedRangeModel model = (BoundedRangeModel)(e.getSource());</b>
<b class="nc"><i>1152</i>&nbsp;            Point p = viewport.getViewPosition();</b>
<b class="nc"><i>1153</i>&nbsp;            int value = model.getValue();</b>
<i>1154</i>&nbsp;            if (scrollpane.getComponentOrientation().isLeftToRight()) {
<b class="nc"><i>1155</i>&nbsp;                p.x = value;</b>
<b class="nc"><i>1156</i>&nbsp;            } else {</b>
<b class="nc"><i>1157</i>&nbsp;                int max = viewport.getViewSize().width;</b>
<i>1158</i>&nbsp;                int extent = viewport.getExtentSize().width;
<b class="nc"><i>1159</i>&nbsp;                int oldX = p.x;</b>
<b class="nc"><i>1160</i>&nbsp;</b>
<i>1161</i>&nbsp;                /* Set new X coordinate based on &quot;value&quot;.
<i>1162</i>&nbsp;                 */
<b class="nc"><i>1163</i>&nbsp;                p.x = max - extent - value;</b>
<b class="nc"><i>1164</i>&nbsp;</b>
<b class="nc"><i>1165</i>&nbsp;                /* If setValue() was called before &quot;extent&quot; was fixed,</b>
<b class="nc"><i>1166</i>&nbsp;                 * turn setValueCalled flag on.</b>
<b class="nc"><i>1167</i>&nbsp;                 */</b>
<b class="nc"><i>1168</i>&nbsp;                if ((extent == 0) &amp;&amp; (value != 0) &amp;&amp; (oldX == max)) {</b>
<b class="nc"><i>1169</i>&nbsp;                    setValueCalled = true;</b>
<b class="nc"><i>1170</i>&nbsp;                } else {</b>
<i>1171</i>&nbsp;                    /* When a pane without a horizontal scroll bar was
<b class="nc"><i>1172</i>&nbsp;                     * reduced and the bar appeared, the viewport should</b>
<i>1173</i>&nbsp;                     * show the right side of the view.
<b class="nc"><i>1174</i>&nbsp;                     */</b>
<i>1175</i>&nbsp;                    if ((extent != 0) &amp;&amp; (oldX &lt; 0) &amp;&amp; (p.x == 0)) {
<i>1176</i>&nbsp;                        p.x += value;
<i>1177</i>&nbsp;                    }
<i>1178</i>&nbsp;                }
<i>1179</i>&nbsp;            }
<i>1180</i>&nbsp;            viewport.setViewPosition(p);
<i>1181</i>&nbsp;        }
<i>1182</i>&nbsp;
<i>1183</i>&nbsp;        //
<i>1184</i>&nbsp;        // PropertyChangeListener: This is installed on both the JScrollPane
<i>1185</i>&nbsp;        // and the horizontal/vertical scrollbars.
<i>1186</i>&nbsp;        //
<i>1187</i>&nbsp;
<i>1188</i>&nbsp;        // Listens for changes in the model property and reinstalls the
<i>1189</i>&nbsp;        // horizontal/vertical PropertyChangeListeners.
<i>1190</i>&nbsp;        public void propertyChange(PropertyChangeEvent e) {
<i>1191</i>&nbsp;            if (e.getSource() == scrollpane) {
<i>1192</i>&nbsp;                scrollPanePropertyChange(e);
<i>1193</i>&nbsp;            }
<i>1194</i>&nbsp;            else {
<i>1195</i>&nbsp;                sbPropertyChange(e);
<i>1196</i>&nbsp;            }
<i>1197</i>&nbsp;        }
<i>1198</i>&nbsp;
<i>1199</i>&nbsp;        private void scrollPanePropertyChange(PropertyChangeEvent e) {
<i>1200</i>&nbsp;            String propertyName = e.getPropertyName();
<i>1201</i>&nbsp;
<i>1202</i>&nbsp;            if (propertyName == &quot;verticalScrollBarDisplayPolicy&quot;) {
<i>1203</i>&nbsp;                updateScrollBarDisplayPolicy(e);
<i>1204</i>&nbsp;            }
<i>1205</i>&nbsp;            else if (propertyName == &quot;horizontalScrollBarDisplayPolicy&quot;) {
<i>1206</i>&nbsp;                updateScrollBarDisplayPolicy(e);
<i>1207</i>&nbsp;            }
<i>1208</i>&nbsp;            else if (propertyName == &quot;viewport&quot;) {
<i>1209</i>&nbsp;                updateViewport(e);
<i>1210</i>&nbsp;            }
<i>1211</i>&nbsp;            else if (propertyName == &quot;rowHeader&quot;) {
<i>1212</i>&nbsp;                updateRowHeader(e);
<i>1213</i>&nbsp;            }
<i>1214</i>&nbsp;            else if (propertyName == &quot;columnHeader&quot;) {
<i>1215</i>&nbsp;                updateColumnHeader(e);
<i>1216</i>&nbsp;            }
<i>1217</i>&nbsp;            else if (propertyName == &quot;verticalScrollBar&quot;) {
<i>1218</i>&nbsp;                updateVerticalScrollBar(e);
<i>1219</i>&nbsp;            }
<i>1220</i>&nbsp;            else if (propertyName == &quot;horizontalScrollBar&quot;) {
<i>1221</i>&nbsp;                updateHorizontalScrollBar(e);
<i>1222</i>&nbsp;            }
<i>1223</i>&nbsp;            else if (propertyName == &quot;componentOrientation&quot;) {
<i>1224</i>&nbsp;                scrollpane.revalidate();
<i>1225</i>&nbsp;                scrollpane.repaint();
<i>1226</i>&nbsp;            }
<i>1227</i>&nbsp;        }
<i>1228</i>&nbsp;
<i>1229</i>&nbsp;        // PropertyChangeListener for the horizontal and vertical scrollbars.
<i>1230</i>&nbsp;        private void sbPropertyChange(PropertyChangeEvent e) {
<i>1231</i>&nbsp;            String propertyName = e.getPropertyName();
<i>1232</i>&nbsp;            Object source = e.getSource();
<i>1233</i>&nbsp;
<i>1234</i>&nbsp;            if (&quot;model&quot; == propertyName) {
<i>1235</i>&nbsp;                JScrollBar sb = scrollpane.getVerticalScrollBar();
<i>1236</i>&nbsp;                BoundedRangeModel oldModel = (BoundedRangeModel)e.
<i>1237</i>&nbsp;                                     getOldValue();
<i>1238</i>&nbsp;                ChangeListener cl = null;
<i>1239</i>&nbsp;
<i>1240</i>&nbsp;                if (source == sb) {
<i>1241</i>&nbsp;                    cl = vsbChangeListener;
<i>1242</i>&nbsp;                }
<i>1243</i>&nbsp;                else if (source == scrollpane.getHorizontalScrollBar()) {
<i>1244</i>&nbsp;                    sb = scrollpane.getHorizontalScrollBar();
<i>1245</i>&nbsp;                    cl = hsbChangeListener;
<i>1246</i>&nbsp;                }
<i>1247</i>&nbsp;                if (cl != null) {
<i>1248</i>&nbsp;                    if (oldModel != null) {
<i>1249</i>&nbsp;                        oldModel.removeChangeListener(cl);
<i>1250</i>&nbsp;                    }
<i>1251</i>&nbsp;                    if (sb.getModel() != null) {
<i>1252</i>&nbsp;                        sb.getModel().addChangeListener(cl);
<i>1253</i>&nbsp;                    }
<i>1254</i>&nbsp;                }
<i>1255</i>&nbsp;            }
<i>1256</i>&nbsp;            else if (&quot;componentOrientation&quot; == propertyName) {
<i>1257</i>&nbsp;                if (source == scrollpane.getHorizontalScrollBar()) {
<i>1258</i>&nbsp;                    JScrollBar hsb = scrollpane.getHorizontalScrollBar();
<i>1259</i>&nbsp;                    JViewport viewport = scrollpane.getViewport();
<i>1260</i>&nbsp;                    Point p = viewport.getViewPosition();
<i>1261</i>&nbsp;                    if (scrollpane.getComponentOrientation().isLeftToRight()) {
<i>1262</i>&nbsp;                        p.x = hsb.getValue();
<i>1263</i>&nbsp;                    } else {
<i>1264</i>&nbsp;                        p.x = viewport.getViewSize().width - viewport.getExtentSize().width - hsb.getValue();
<i>1265</i>&nbsp;                    }
<i>1266</i>&nbsp;                    viewport.setViewPosition(p);
<i>1267</i>&nbsp;                }
<i>1268</i>&nbsp;            }
<i>1269</i>&nbsp;        }
<i>1270</i>&nbsp;    }
<i>1271</i>&nbsp;}
</div>
</div>

<div class="footer">
    
    <div style="float:right;">generated on 2018-11-19 23:15</div>
</div>
</body>
</html>
